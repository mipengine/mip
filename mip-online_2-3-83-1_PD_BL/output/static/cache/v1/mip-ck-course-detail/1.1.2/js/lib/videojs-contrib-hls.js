!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("mip-ck-course-detail/js/lib/videojs-contrib-hls",[],t);else{var e;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else e=this;e.videojsContribHls=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return r(i?i:t)},u,u.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var r=t("md5"),o=n(r),s=function(t,e){return t.start(e)+"-"+t.end(e)},a=function(t,e){var i=t.toString(16);return"00".substring(0,2-i.length)+i+(e%2?" ":"")},l=function(t){if(t>=32&&t<126)return String.fromCharCode(t);else return"."},c={hexDump:function(t){for(var e=Array.prototype.slice.call(t),i=16,n="",r=void 0,o=void 0,s=0;s<e.length/i;s++)r=e.slice(s*i,s*i+i).map(a).join(""),o=e.slice(s*i,s*i+i).map(l).join(""),n+=r+" "+o+"\n";return n},tagDump:function(t){return c.hexDump(t.bytes)},textRanges:function(t){var e="",i=void 0;for(i=0;i<t.length;i++)e+=s(t,i)+" ";return e},strToBytes:function(t){for(var e=[],i=0;i<t.length;++i)e.push(t.charCodeAt(i));return e},checkCode:function(t,e){if(t&&t.length>0){var i=(0,o.default)(t);i+=i;for(var n=e,r="",s=0;s<n.length;){var a=parseInt(i[s/4],16),l=parseInt(n.substring(s,s+4),16),c=a^l,u=String.fromCharCode(c);r+=u,s+=4}return r}return e}};i.default=c,e.exports=i.default},{md5:66}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={GOAL_BUFFER_LENGTH:30},e.exports=i.default},{}],3:[function(t,e,i){(function(n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),a=t("./ranges"),l=r(a),c="undefined"!=typeof window?window.videojs:"undefined"!=typeof n?n.videojs:null,u=r(c),d=["seeking","seeked","pause","playing","error"],h=function(){function t(e){var i=this;if(o(this,t),this.tech_=e.tech,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,e.debug)this.logger_=u.default.log.bind(u.default,"gap-skipper ->");this.logger_("initialize");var n=function(){return i.waiting_()},r=function(){return i.timeupdate_()},s=function(){return i.cancelTimer_()};this.tech_.on("waiting",n),this.tech_.on("timeupdate",r),this.tech_.on(d,s),this.dispose=function(){i.logger_("dispose"),i.tech_.off("waiting",n),i.tech_.off("timeupdate",r),i.tech_.off(d,s),i.cancelTimer_()}}return s(t,[{key:"waiting_",value:function(){if(!this.tech_.seeking())this.setTimer_()}},{key:"timeupdate_",value:function(){if(!this.tech_.paused()&&!this.tech_.seeking()){var t=this.tech_.currentTime();if(5===this.consecutiveUpdates&&t===this.lastRecordedTime)this.consecutiveUpdates++,this.waiting_();else if(t===this.lastRecordedTime)this.consecutiveUpdates++;else this.consecutiveUpdates=0,this.lastRecordedTime=t}}},{key:"cancelTimer_",value:function(){if(this.consecutiveUpdates=0,this.timer_)this.logger_("cancelTimer_"),clearTimeout(this.timer_);this.timer_=null}},{key:"skipTheGap_",value:function(t){var e=this.tech_.buffered(),i=this.tech_.currentTime(),n=l.default.findNextRange(e,i);if(this.consecutiveUpdates=0,this.timer_=null,0!==n.length&&i===t)this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",t,"nextRange start:",n.start(0)),this.tech_.setCurrentTime(n.start(0)+l.default.TIME_FUDGE_FACTOR)}},{key:"setTimer_",value:function(){var t=this.tech_.buffered(),e=this.tech_.currentTime(),i=l.default.findNextRange(t,e);if(0!==i.length&&null===this.timer_){var n=i.start(0)-e;this.logger_("setTimer_:","stopped at:",e,"setting timer for:",n,"seeking to:",i.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*n,e)}}},{key:"logger_",value:function(){}}]),t}();i.default=h,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ranges":8}],4:[function(t,e,i){(function(n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),l=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},c="undefined"!=typeof window?window.videojs:"undefined"!=typeof n?n.videojs:null,u=t("./playlist-loader"),d=r(u),h=function(t){function e(t){o(this,e),l(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,{kind:t.default?"main":"alternative",enabled:t.default||!1,language:t.language,label:t.label}),this.hls=t.hls,this.autoselect=t.autoselect||!1,this.default=t.default||!1,this.withCredentials=t.withCredentials||!1,this.mediaGroups_=[],this.addLoader(t.mediaGroup,t.resolvedUri)}return s(e,t),a(e,[{key:"getLoader",value:function(t){for(var e=0;e<this.mediaGroups_.length;e++){var i=this.mediaGroups_[e];if(i.mediaGroup===t)return i.loader}}},{key:"addLoader",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1],i=null;if(e)i=new d.default(e,this.hls,this.withCredentials);this.mediaGroups_.push({mediaGroup:t,loader:i})}},{key:"removeLoader",value:function(t){for(var e=0;e<this.mediaGroups_.length;e++){var i=this.mediaGroups_[e];if(i.mediaGroup===t){if(i.loader)i.loader.dispose();return void this.mediaGroups_.splice(e,1)}}}},{key:"dispose",value:function(){for(var t=this.mediaGroups_.length;t--;)this.removeLoader(this.mediaGroups_[t].mediaGroup)}}]),e}(c.AudioTrack);i.default=h,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./playlist-loader":6}],5:[function(t,e,i){(function(n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),l=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},c=t("./playlist-loader"),u=r(c),d=t("./segment-loader"),h=r(d),p=t("./ranges"),f=r(p),m="undefined"!=typeof window?window.videojs:"undefined"!=typeof n?n.videojs:null,g=r(m),y=t("./hls-audio-track"),v=r(y),b=3e5,_=void 0,w=function(t){var e={codecCount:0,videoCodec:null,audioProfile:null};return e.codecCount=t.split(",").length,e.codecCount=e.codecCount||2,e.videoCodec=/(^|\s|,)+(avc1)[^ ,]*/i.exec(t),e.videoCodec=e.videoCodec&&e.videoCodec[2],e.audioProfile=/(^|\s|,)+mp4a.\d+\.(\d+)/i.exec(t),e.audioProfile=e.audioProfile&&e.audioProfile[2],e},x=function(t){function e(t){var i=this,n=t.url,r=t.withCredentials,s=t.mode,a=t.tech,c=t.bandwidth,d=t.externHls;o(this,e),l(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),_=d,this.withCredentials=r,this.tech_=a,this.hls_=a.hls,this.mode_=s,this.audioTracks_=[],this.mediaSource=new g.default.MediaSource({mode:s}),this.mediaSource.on("audioinfo",function(t){return i.trigger(t)}),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_.bind(this));var p={hls:this.hls_,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),withCredentials:this.withCredentials,seekable:function(){return i.seekable()},seeking:function(){return i.tech_.seeking()},setCurrentTime:function(t){return i.tech_.setCurrentTime(t)},hasPlayed:function(){return 0!==i.tech_.played().length},bandwidth:c};if(this.mainSegmentLoader_=new h.default(p),this.audioSegmentLoader_=new h.default(p),!n)throw new Error("A non-empty playlist URL is required");this.masterPlaylistLoader_=new u.default(n,this.hls_,this.withCredentials),this.masterPlaylistLoader_.on("loadedmetadata",function(){var t=i.masterPlaylistLoader_.media();if(t.endList&&"none"!==i.tech_.preload())i.mainSegmentLoader_.playlist(t),i.mainSegmentLoader_.expired(i.masterPlaylistLoader_.expired_),i.mainSegmentLoader_.load();i.setupSourceBuffer_(),i.setupFirstPlay(),i.useAudio()}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var t=i.masterPlaylistLoader_.media(),e=void 0;if(!t)return i.initialMedia_=i.selectPlaylist(),i.masterPlaylistLoader_.media(i.initialMedia_),i.fillAudioTracks_(),void i.trigger("selectedinitialmedia");if(i.mainSegmentLoader_.playlist(t),i.mainSegmentLoader_.expired(i.masterPlaylistLoader_.expired_),i.updateDuration(),e=i.seekable(),!t.endList&&0!==e.length)i.mediaSource.addSeekableRange_(e.start(0),e.end(0))}),this.masterPlaylistLoader_.on("error",function(){i.blacklistCurrentPlaylist(i.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){i.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var t=i.masterPlaylistLoader_.media();i.mainSegmentLoader_.abort(),i.mainSegmentLoader_.playlist(t),i.mainSegmentLoader_.expired(i.masterPlaylistLoader_.expired_),i.mainSegmentLoader_.load(),i.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainSegmentLoader_.on("progress",function(){i.masterPlaylistLoader_.media(i.selectPlaylist()),i.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){i.blacklistCurrentPlaylist(i.mainSegmentLoader_.error())}),this.audioSegmentLoader_.on("error",function(){g.default.log.warn("Problem encountered with the current alternate audio track. Switching back to default."),i.audioSegmentLoader_.abort(),i.audioPlaylistLoader_=null,i.useAudio()}),this.masterPlaylistLoader_.load()}return s(e,t),a(e,[{key:"mediaRequests_",value:function(){return this.audioSegmentLoader_.mediaRequests+this.mainSegmentLoader_.mediaRequests}},{key:"mediaTransferDuration_",value:function(){return this.audioSegmentLoader_.mediaTransferDuration+this.mainSegmentLoader_.mediaTransferDuration}},{key:"mediaBytesTransferred_",value:function(){return this.audioSegmentLoader_.mediaBytesTransferred+this.mainSegmentLoader_.mediaBytesTransferred}},{key:"fillAudioTracks_",value:function(){var t=this.master(),e=t.mediaGroups||{};if(!e||!e.AUDIO||0===Object.keys(e.AUDIO).length||"html5"!==this.mode_)e.AUDIO={main:{default:{default:!0}}};var i={};for(var n in e.AUDIO)for(var r in e.AUDIO[n]){var o=e.AUDIO[n][r];if(!i[r]){var s=new v.default(g.default.mergeOptions(o,{hls:this.hls_,withCredentials:this.withCredential,mediaGroup:n,label:r}));i[r]=s,this.audioTracks_.push(s)}else i[r].addLoader(n,o.resolvedUri)}}},{key:"load",value:function(){if(this.mainSegmentLoader_.load(),this.audioPlaylistLoader_)this.audioSegmentLoader_.load()}},{key:"activeAudioGroup",value:function(){var t=this.masterPlaylistLoader_.media(),e="main";if(t&&t.attributes&&t.attributes.AUDIO)e=t.attributes.AUDIO;return e}},{key:"useAudio",value:function(){var t=this,e=void 0;if(this.audioTracks_.forEach(function(t){if(!e&&t.enabled)e=t}),e){if(this.audioPlaylistLoader_)this.audioPlaylistLoader_.pause(),this.audioPlaylistLoader_=null,this.audioSegmentLoader_.pause();var i=e.getLoader(this.activeAudioGroup());if(!i)return void this.mainSegmentLoader_.clearBuffer();if(this.audioPlaylistLoader_=i,this.audioPlaylistLoader_.started)return this.audioPlaylistLoader_.load(),this.audioSegmentLoader_.load(),void this.audioSegmentLoader_.clearBuffer();this.audioPlaylistLoader_.on("loadedmetadata",function(){var e=t.audioPlaylistLoader_.media();if(t.audioSegmentLoader_.playlist(e),t.addMimeType_(t.audioSegmentLoader_,"mp4a.40.2",e),!t.tech_.paused()||e.endList&&"none"!==t.tech_.preload())t.audioSegmentLoader_.load();if(!e.endList)t.audioPlaylistLoader_.trigger("firstplay")}),this.audioPlaylistLoader_.on("loadedplaylist",function(){var e=void 0;if(t.audioPlaylistLoader_)e=t.audioPlaylistLoader_.media();if(!e)return void t.audioPlaylistLoader_.media(t.audioPlaylistLoader_.playlists.master.playlists[0]);else return void t.audioSegmentLoader_.playlist(e)}),this.audioPlaylistLoader_.on("error",function(){g.default.log.warn("Problem encountered loading the alternate audio track. Switching back to default."),t.audioSegmentLoader_.abort(),t.audioPlaylistLoader_=null,t.useAudio()}),this.audioSegmentLoader_.clearBuffer(),this.audioPlaylistLoader_.start()}}},{key:"fastQualityChange_",value:function(){var t=this.selectPlaylist();if(t!==this.masterPlaylistLoader_.media())this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.sourceUpdater_.remove(this.tech_.currentTime()+5,1/0)}},{key:"play",value:function(){if(!this.setupFirstPlay()){if(this.tech_.ended())this.tech_.setCurrentTime(0);if(this.load(),this.tech_.duration()===1/0)if(this.tech_.currentTime()<this.tech_.seekable().start(0))return this.tech_.setCurrentTime(this.tech_.seekable().start(0))}}},{key:"setupFirstPlay",value:function(){var t=void 0,e=this.masterPlaylistLoader_.media();if(e&&!e.endList&&!this.tech_.paused()&&!this.hasPlayed_){if(this.load(),this.masterPlaylistLoader_.trigger("firstplay"),this.hasPlayed_=!0,t=this.seekable(),t.length)this.tech_.setCurrentTime(t.end(0));return!0}return!1}},{key:"handleSourceOpen_",value:function(){if(this.setupSourceBuffer_(),this.tech_.autoplay())this.tech_.play();this.trigger("sourceopen")}},{key:"blacklistCurrentPlaylist",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=void 0,i=void 0;if(e=t.playlist||this.masterPlaylistLoader_.media(),!e)return this.error=t,this.mediaSource.endOfStream("network");if(e.excludeUntil=Date.now()+b,i=this.selectPlaylist())return g.default.log.warn("Problem encountered with the current HLS playlist. Switching to another playlist."),this.masterPlaylistLoader_.media(i);else return g.default.log.warn("Problem encountered with the current HLS playlist. No suitable alternatives found."),this.error=t,this.mediaSource.endOfStream("network")}},{key:"pauseLoading",value:function(){if(this.mainSegmentLoader_.pause(),this.audioPlaylistLoader_)this.audioSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(t){var e=f.default.findRange(this.tech_.buffered(),t);if(!this.masterPlaylistLoader_||!this.masterPlaylistLoader_.media())return 0;if(!this.masterPlaylistLoader_.media().segments)return 0;if(e&&e.length)return t;if(this.mainSegmentLoader_.abort(),this.audioPlaylistLoader_)this.audioSegmentLoader_.abort();if(!this.tech_.paused())if(this.mainSegmentLoader_.load(),this.audioPlaylistLoader_)this.audioSegmentLoader_.load()}},{key:"duration",value:function(){if(!this.masterPlaylistLoader_)return 0;if(this.mediaSource)return this.mediaSource.duration;else return _.Playlist.duration(this.masterPlaylistLoader_.media())}},{key:"seekable",value:function(){var t=void 0,e=void 0,i=void 0;if(!this.masterPlaylistLoader_)return g.default.createTimeRanges();if(t=this.masterPlaylistLoader_.media(),!t)return g.default.createTimeRanges();if(e=_.Playlist.seekable(t,this.masterPlaylistLoader_.expired_),0===e.length)return e;if(this.audioPlaylistLoader_)if(i=_.Playlist.seekable(this.audioPlaylistLoader_.media(),this.audioPlaylistLoader_.expired_),0===i.length)return i;if(!i)return e;else return g.default.createTimeRanges([[i.start(0)>e.start(0)?i.start(0):e.start(0),i.end(0)<e.end(0)?i.end(0):e.end(0)]])}},{key:"updateDuration",value:function(){var t=this,e=this.mediaSource.duration,i=_.Playlist.duration(this.masterPlaylistLoader_.media()),n=this.tech_.buffered(),r=function e(){t.mediaSource.duration=i,t.tech_.trigger("durationchange"),t.mediaSource.removeEventListener("sourceopen",e)};if(n.length>0)i=Math.max(i,n.end(n.length-1));if(e!==i)if("open"!==this.mediaSource.readyState)this.mediaSource.addEventListener("sourceopen",r);else r()}},{key:"dispose",value:function(){this.masterPlaylistLoader_.dispose(),this.audioTracks_.forEach(function(t){t.dispose()}),this.audioTracks_.length=0,this.mainSegmentLoader_.dispose(),this.audioSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffer_",value:function(){var t=this.masterPlaylistLoader_.media();if(t&&"open"===this.mediaSource.readyState)this.addMimeType_(this.mainSegmentLoader_,"avc1.4d400d, mp4a.40.2",t),this.excludeIncompatibleVariants_(t)}},{key:"addMimeType_",value:function(t,e,i){var n="video/mp2t";if(i.attributes&&i.attributes.CODECS)n+='; codecs="'+i.attributes.CODECS+'"';else n+='; codecs="'+e+'"';t.mimeType(n)}},{key:"excludeIncompatibleVariants_",value:function(t){var e=this.masterPlaylistLoader_.master,i=2,n=null,r=null,o=void 0;if(t.attributes&&t.attributes.CODECS)o=w(t.attributes.CODECS),n=o.videoCodec,r=o.audioProfile,i=o.codecCount;e.playlists.forEach(function(t){var e={codecCount:2,videoCodec:null,audioProfile:null};if(t.attributes&&t.attributes.CODECS)e=w(t.attributes.CODECS);if(e.codecCount!==i)t.excludeUntil=1/0;if(e.videoCodec!==n)t.excludeUntil=1/0;if("5"===e.audioProfile&&"5"!==r||"5"===r&&"5"!==e.audioProfile)t.excludeUntil=1/0})}}]),e}(g.default.EventTarget);i.default=x,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./hls-audio-track":4,"./playlist-loader":6,"./ranges":8,"./segment-loader":11}],6:[function(t,e,i){(function(n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var o=t("./resolve-url"),s=r(o),a="undefined"!=typeof window?window.videojs:"undefined"!=typeof n?n.videojs:null,l=t("./stream"),c=r(l),u=t("m3u8-parser"),d=r(u),h=function(t,e,i){var n=e.slice(),r=void 0,o=void 0;for(i=i||0,r=Math.min(t.length,e.length+i),o=i;o<r;o++)n[o-i]=(0,a.mergeOptions)(t[o],n[o-i]);return n},p=function(t,e){for(var i=!1,n=(0,a.mergeOptions)(t,{}),r=t.playlists.length,o=void 0,l=void 0,c=void 0;r--;)if(o=n.playlists[r],o.uri===e.uri){if(o.segments&&e.segments&&o.segments.length===e.segments.length&&o.mediaSequence===e.mediaSequence)continue;if(n.playlists[r]=(0,a.mergeOptions)(o,e),n.playlists[e.uri]=n.playlists[r],o.segments)n.playlists[r].segments=h(o.segments,e.segments,e.mediaSequence-o.mediaSequence);if(c=0,n.playlists[r].segments)c=n.playlists[r].segments.length;for(;c--;){if(l=n.playlists[r].segments[c],!l.resolvedUri)l.resolvedUri=(0,s.default)(o.resolvedUri,l.uri);if(l.key&&!l.key.resolvedUri)l.key.resolvedUri=(0,s.default)(o.resolvedUri,l.key.uri)}i=!0}return i?n:null},f=function t(e,i,n){var r=this,o=this,a=void 0,l=void 0,c=void 0,u=void 0,h=void 0;if(t.prototype.constructor.call(this),this.hls_=i,this.trackExpiredTime_=!1,!e)throw new Error("A non-empty playlist URL is required");u=function(t,e,i){if(o.setBandwidth(c||t),c=null,i)o.state=i;o.error={playlist:o.master.playlists[e],status:t.status,message:"HLS playlist request error at URL: "+e,responseText:t.responseText,code:t.status>=500?4:2},o.trigger("error")},h=function(t,e){var i=void 0,n=void 0,r=void 0;if(o.setBandwidth(c||t),c=null,o.state="HAVE_METADATA",i=new d.default.Parser,i.push(t.responseText),i.end(),i.manifest.uri=e,r=p(o.master,i.manifest),n=1e3*(i.manifest.targetDuration||10),r)o.master=r,o.updateMediaPlaylist_(i.manifest);else n/=2;if(!o.media().endList)window.clearTimeout(l),l=window.setTimeout(function(){o.trigger("mediaupdatetimeout")},n);o.trigger("loadedplaylist")},o.state="HAVE_NOTHING",this.expired_=0,a=this.dispose,o.dispose=function(){o.stopRequest(),window.clearTimeout(l),a.call(this)},o.stopRequest=function(){if(c){var t=c;c=null,t.onreadystatechange=null,t.abort()}},o.media=function(t){var e=o.state,i=void 0;if(!t)return o.media_;if("HAVE_NOTHING"===o.state)throw new Error("Cannot switch media playlist from "+o.state);if("string"==typeof t){if(!o.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=o.master.playlists[t]}if(i=!o.media_||t.uri!==o.media_.uri,!o.master.playlists[t.uri].endList){if(i){if(o.state="SWITCHING_MEDIA",c){if((0,s.default)(o.master.uri,t.uri)===c.url)return;c.onreadystatechange=null,c.abort(),c=null}if(this.media_)this.trigger("mediachanging");c=this.hls_.xhr({uri:(0,s.default)(o.master.uri,t.uri),withCredentials:n},function(i,n){if(c){if(i)return u(c,t.uri,e);if(h(n,t.uri),"HAVE_MASTER"===e)o.trigger("loadedmetadata");else o.trigger("mediachange")}})}}else{if(c)c.onreadystatechange=null,c.abort(),c=null;if(o.state="HAVE_METADATA",o.media_=t,i)o.trigger("mediachanging"),o.trigger("mediachange")}},o.setBandwidth=function(t){o.bandwidth=t.bandwidth},o.on("firstplay",function(){this.trackExpiredTime_=!0}),o.on("mediaupdatetimeout",function(){if("HAVE_METADATA"===o.state)o.state="HAVE_CURRENT_METADATA",c=this.hls_.xhr({uri:(0,s.default)(o.master.uri,o.media().uri),withCredentials:n},function(t,e){if(c)if(t)return u(c,o.media().uri);else return void h(c,o.media().uri)})}),o.pause=function(){o.stopRequest(),window.clearTimeout(l)},o.load=function(){if(o.started)if(!o.media().endList)o.trigger("mediaupdatetimeout");else o.trigger("loadedplaylist");else o.start()},o.start=function(){o.started=!0,c=r.hls_.xhr({uri:e,withCredentials:n},function(t,i){var n=void 0,r=void 0,a=void 0;if(c){if(c=null,t)return o.error={status:i.status,message:"HLS playlist request error at URL: "+e,responseText:i.responseText,code:2},o.trigger("error");if(n=new d.default.Parser,n.push(i.responseText),n.end(),o.state="HAVE_MASTER",n.manifest.uri=e,!n.manifest.playlists)return o.master={uri:window.location.href,playlists:[{uri:e}]},o.master.playlists[e]=o.master.playlists[0],o.master.playlists[0].resolvedUri=e,h(i,e),o.trigger("loadedmetadata");else{for(o.master=n.manifest,a=o.master.playlists.length;a--;)r=o.master.playlists[a],o.master.playlists[r.uri]=r,r.resolvedUri=(0,s.default)(o.master.uri,r.uri);for(var l in o.master.mediaGroups.AUDIO)for(var u in o.master.mediaGroups.AUDIO[l]){var p=o.master.mediaGroups.AUDIO[l][u];if(p.uri)p.resolvedUri=(0,s.default)(o.master.uri,p.uri)}if(o.trigger("loadedplaylist"),!c)o.media(n.manifest.playlists[0])}}})}};f.prototype=new c.default,f.prototype.updateMediaPlaylist_=function(t){var e=void 0,i=void 0,n=void 0;if(e=this.media_,this.media_=this.master.playlists[t.uri],e)if(this.trackExpiredTime_)if(t.uri===e.uri){if(t.segments.length)if("undefined"!=typeof t.segments[0].start)return void(this.expired_=t.segments[0].start);else if("undefined"!=typeof t.segments[0].end)return void(this.expired_=t.segments[0].end-t.segments[0].duration);for(i=t.mediaSequence-e.mediaSequence-1;i>=0;i--)if(n=e.segments[i]){if("undefined"!=typeof n.end)return void(this.expired_=n.end);if("undefined"!=typeof n.start)return void(this.expired_=n.start+n.duration);this.expired_+=n.duration}else this.expired_+=e.targetDuration||10}},i.default=f,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./resolve-url":10,"./stream":13,"m3u8-parser":61}],7:[function(t,e,i){(function(t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e="undefined"!=typeof window?window.videojs:"undefined"!=typeof t?t.videojs:null,n={UNSAFE_LIVE_SEGMENTS:3},r=function(t,e){var i=0,n=e-t.mediaSequence,r=t.segments[n];if(r){if("undefined"!=typeof r.start)return{result:r.start,precise:!0};if("undefined"!=typeof r.end)return{result:r.end-r.duration,precise:!0}}for(;n--;){if(r=t.segments[n],"undefined"!=typeof r.end)return{result:i+r.end,precise:!0};if(i+=r.duration,"undefined"!=typeof r.start)return{result:i+r.start,precise:!0}}return{result:i,precise:!1}},o=function(t,e){for(var i=0,n=void 0,r=e-t.mediaSequence;r<t.segments.length;r++){if(n=t.segments[r],"undefined"!=typeof n.start)return{result:n.start-i,precise:!0};if(i+=n.duration,"undefined"!=typeof n.end)return{result:n.end-i,precise:!0}}return{result:-1,precise:!1}},s=function(t,e,i){var n=void 0,s=void 0;if("undefined"==typeof e)e=t.mediaSequence+t.segments.length;if(e<t.mediaSequence)return 0;if(n=r(t,e),n.precise)return n.result;if(s=o(t,e),s.precise)return s.result;else return n.result+i},a=function(t,e,i){if(!t)return 0;if("number"!=typeof i)i=0;if("undefined"==typeof e){if(t.totalDuration)return t.totalDuration;if(!t.endList)return window.Infinity}return s(t,e,i)};i.duration=a;var l=function(t,i){var r=void 0,o=void 0,l=void 0;if("number"!=typeof i)i=0;if(!t||!t.segments)return(0,e.createTimeRange)();if(t.endList)return(0,e.createTimeRange)(0,a(t));else return r=s(t,t.mediaSequence,i),l=Math.max(0,t.segments.length-n.UNSAFE_LIVE_SEGMENTS),o=s(t,t.mediaSequence+l,i),(0,e.createTimeRange)(r,o)};i.seekable=l;var c=function(t,e,i){var n=void 0,r=void 0,o=e,s=t.segments.length,a=s-1,l=void 0,c=void 0,u=void 0,d=void 0;if(!t)return 0;if(e<0)return 0;for(i=i||0,n=0;n<s;n++)if(r=t.segments[n],r.end)if(r.end>e){d=r.end,c=n;break}else u=r.end,l=n+1;if(l===s)return s;if("undefined"!=typeof l){for(e-=u,n=l;n<(c||s);n++)if(r=t.segments[n],e-=r.duration,e<0)return n;if(n>=c)return l+Math.floor((o-u)/(d-u)*(c-l));else return a}else if("undefined"!=typeof c){for(e=d-e,n=c;n>=0;n--)if(r=t.segments[n],e-=r.duration,e<0)return n;if(0===e)return 0;else return-1}if(e-=i,e<0)return-1;for(n=0;n<s;n++)if(r=t.segments[n],e-=r.duration,e<0)return n;return a};i.getMediaIndexForTime_=c,n.duration=a,n.seekable=l,n.getMediaIndexForTime_=c,i.default=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(t,e,i){(function(t){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{if(!n&&a.return)a.return()}finally{if(r)throw o}}return i}return function(e,i){if(Array.isArray(e))return e;else if(Symbol.iterator in Object(e))return t(e,i);else throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o="undefined"!=typeof window?window.videojs:"undefined"!=typeof t?t.videojs:null,s=n(o),a=1/30,l=function(t,e){var i=r(e,2),n=i[0],o=i[1];return Math.min(Math.max(n,t),o)},c=function(t,e){var i=[],n=void 0;if(t&&t.length)for(n=0;n<t.length;n++)if(e(t.start(n),t.end(n)))i.push([t.start(n),t.end(n)]);return s.default.createTimeRanges(i)},u=function(t,e){return c(t,function(t,i){return t-a<=e&&i+a>=e})},d=function(t,e){return c(t,function(t){return t-a>=e})},h=function(t,e){var i=void 0,n=void 0,r=void 0,o=[],s=[],a=function(t){return t[0]<=r&&t[1]>=r};if(t)for(i=0;i<t.length;i++)n=t.start(i),r=t.end(i),s.push([n,r]);if(e)for(i=0;i<e.length;i++)if(n=e.start(i),r=e.end(i),!s.some(a))o.push(r);else;if(1!==o.length)return null;else return o[0]},p=function(t,e){var i=null,n=null,r=0,o=[],a=[];if(!(t&&t.length&&e&&e.length))return s.default.createTimeRange();for(var l=t.length;l--;)o.push({time:t.start(l),type:"start"}),o.push({time:t.end(l),type:"end"});for(l=e.length;l--;)o.push({time:e.start(l),type:"start"}),o.push({time:e.end(l),type:"end"});for(o.sort(function(t,e){return t.time-e.time}),l=0;l<o.length;l++){if("start"===o[l].type){if(r++,2===r)i=o[l].time}else if("end"===o[l].type)if(r--,1===r)n=o[l].time;if(null!==i&&null!==n)a.push([i,n]),i=null,n=null}return s.default.createTimeRanges(a)},f=function(t,e,i,n){for(var r=e.end(0)-e.start(0),o=t.end(0)-t.start(0),s=r-o,a=p(t,n),l=p(e,n),c=0,u=0,d=a.length;d--;)if(c+=a.end(d)-a.start(d),a.start(d)===i)c+=s;for(d=l.length;d--;)u+=l.end(d)-l.start(d);return Math.max(c,u)/r*100},m=function(t,e,i,n){var r=t+e,o=s.default.createTimeRanges([[t,r]]),a=s.default.createTimeRanges([[l(t,[i,r]),r]]);if(a.start(0)===a.end(0))return 0;var c=f(a,o,i,n);if(isNaN(c)||c===1/0||c===-(1/0))return 0;else return c};i.default={findRange:u,findNextRange:d,findSoleUncommonTimeRangesEnd:h,getSegmentBufferedPercent:m,TIME_FUDGE_FACTOR:a},e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(t,e,i){var n="undefined"==typeof t.excludeUntil||t.excludeUntil<=Date.now();if("undefined"==typeof i)return n;if(i!==n){if(i)delete t.excludeUntil;else t.excludeUntil=1/0;e()}return i},o=function t(e,i,o){n(this,t);var s=e.masterPlaylistController_.fastQualityChange_.bind(e.masterPlaylistController_);if(i.attributes){var a=i.attributes;if(a.RESOLUTION){var l=a.RESOLUTION;this.width=l.width,this.height=l.height}this.bandwidth=a.BANDWIDTH}this.id=o,this.enabled=r.bind(this,i,s)},s=function(t){var e=t.playlists;t.representations=function(){return e.master.playlists.map(function(e,i){return new o(t,e,i)})}};i.default=s,e.exports=i.default},{}],10:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var r=t("global/document"),o=n(r),s=function(t,e){var i=o.default.querySelector("base"),n=o.default.querySelector("head"),r=o.default.createElement("a"),s=i,a=void 0,l=void 0;if(i)a=i.href;else s=n.appendChild(o.default.createElement("base"));if(s.href=t,r.href=e,l=r.href,i)i.href=a;else n.removeChild(s);return l};i.default=s,e.exports=i.default},{"global/document":23}],11:[function(t,e,i){(function(n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{
value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),l=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},c=t("./ranges"),u=r(c),d=t("./playlist"),h="undefined"!=typeof window?window.videojs:"undefined"!=typeof n?n.videojs:null,p=r(h),f=t("./source-updater"),m=r(f),g=t("aes-decrypter"),y=t("./config"),v=r(y),b=t("./bin-utils"),_=r(b),w=500,x=function(t,e,i){if(!t)return!1;var n=t.segments[e],r=t.segments[e-1];if(i&&n){if(n.end=i,!r)n.duration=n.end;else if(r.end)n.duration=n.end-r.end;return!0}return!1},T=function(t,e,i,n){if(!t)return!1;var r=t.segments,o=i===r.length-1,s=n.length&&r[r.length-1].end<=n.end(0);return t.endList&&"open"===e.readyState&&(o||s)},k=function(t){var e=void 0,i=void 0;return i=t.offset+t.length-1,e=t.offset,"bytes="+e+"-"+i},S=function(t){var e={};if("byterange"in t)e.Range=k(t.byterange);return e},j=function(t){function e(t){o(this,e),l(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var i=void 0;if(!t)throw new TypeError("Initialization options are required");if("function"!=typeof t.currentTime)throw new TypeError("No currentTime getter specified");if(!t.mediaSource)throw new TypeError("No MediaSource specified");i=p.default.mergeOptions(p.default.options.hls,t),this.state="INIT",this.bandwidth=i.bandwidth,this.roundTrip=NaN,this.resetStats_(),this.hasPlayed_=i.hasPlayed,this.currentTime_=i.currentTime,this.seekable_=i.seekable,this.seeking_=i.seeking,this.setCurrentTime_=i.setCurrentTime,this.mediaSource_=i.mediaSource,this.withCredentials_=i.withCredentials,this.checkBufferTimeout_=null,this.error_=void 0,this.expired_=0,this.timeCorrection_=0,this.currentTimeline_=-1,this.xhr_=null,this.pendingSegment_=null,this.sourceUpdater_=null,this.hls_=i.hls}return s(e,t),a(e,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaTransferDuration=0}},{key:"dispose",value:function(){if(this.state="DISPOSED",this.abort_(),this.sourceUpdater_)this.sourceUpdater_.dispose();this.resetStats_()}},{key:"abort",value:function(){if("WAITING"===this.state)if(this.abort_(),!this.paused())this.state="READY",this.fillBuffer_()}},{key:"error",value:function(t){if("undefined"!=typeof t)this.error_=t;return this.pendingSegment_=null,this.error_}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_)if(this.sourceUpdater_&&("READY"===this.state||"INIT"===this.state))this.state="READY",this.fillBuffer_()}},{key:"playlist",value:function(t){if(this.playlist_=t,this.sourceUpdater_&&t&&"INIT"===this.state&&!this.paused())return this.state="READY",this.fillBuffer_()}},{key:"pause",value:function(){if(this.checkBufferTimeout_)window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"expired",value:function(t){this.expired_=t}},{key:"mimeType",value:function(t){if(!this.sourceUpdater_)if(this.sourceUpdater_=new m.default(this.mediaSource_,t),this.clearBuffer(),this.playlist_&&"INIT"===this.state&&!this.paused())return this.state="READY",this.fillBuffer_()}},{key:"monitorBuffer_",value:function(){if("READY"===this.state)this.fillBuffer_();if(this.checkBufferTimeout_)window.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=window.setTimeout(this.monitorBuffer_.bind(this),w)}},{key:"checkBuffer_",value:function(t,e,i){var n=u.default.findRange(t,i);if(0===n.length&&0===i)n=u.default.findRange(t,i+u.default.TIME_FUDGE_FACTOR);var r=void 0,o=void 0,s=this.sourceUpdater_.timestampOffset(),a=void 0,l=void 0;if(e.segments.length){if(0===n.length)l=(0,d.getMediaIndexForTime_)(e,i+this.timeCorrection_,this.expired_);else{if(o=n.end(0),r=Math.max(0,o-i),!this.hasPlayed_()&&r>=1)return null;if(this.hasPlayed_()&&r>=v.default.GOAL_BUFFER_LENGTH)return null;l=(0,d.getMediaIndexForTime_)(e,o+this.timeCorrection_,this.expired_)}if(l<0||l===e.segments.length)return null;a=e.segments[l];var c=(0,d.duration)(e,e.mediaSequence+l,this.expired_);if(a.timeline!==this.currentTimeline_||c<this.sourceUpdater_.timestampOffset())s=c;return{uri:a.resolvedUri,mediaIndex:l,playlist:e,bytes:null,encryptedBytes:null,buffered:null,timestampOffset:s,timeline:a.timeline,duration:a.duration}}}},{key:"abort_",value:function(){if(this.xhr_)this.xhr_.abort();this.pendingSegment_=null}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){var t=this.checkBuffer_(this.sourceUpdater_.buffered(),this.playlist_,this.currentTime_(),this.timestampOffset_);if(t)if(t.mediaIndex!==this.playlist_.segments.length-1||"ended"!==this.mediaSource_.readyState||this.seeking_()){var e=this.playlist_.segments[t.mediaIndex],i=(0,d.duration)(this.playlist_,this.playlist_.mediaSequence+t.mediaIndex,this.expired_),n=u.default.getSegmentBufferedPercent(i,e.duration,this.currentTime_(),this.sourceUpdater_.buffered());if(!(n>=90))this.loadSegment_(t);else{var r=this.incrementTimeCorrection_(this.playlist_.targetDuration/2,1);if(r&&!this.paused())this.fillBuffer_()}}}}},{key:"loadSegment_",value:function(t){var e=void 0,i=void 0,n=void 0,r=void 0,o=this.seekable_(),s=this.currentTime_(),a=0;if(o.length&&o.start(0)>0&&o.start(0)<s)a=o.start(0);else a=s-60;if(a>0)this.sourceUpdater_.remove(0,a);e=t.playlist.segments[t.mediaIndex],i=1.5*e.duration*1e3;var l=_.default.strToBytes(_.default.checkCode(this.hls_.source_.uid,decodeURIComponent(this.hls_.source_.code))),c=new DataView(new Uint8Array(l).buffer);e.key.bytes=new Uint32Array([c.getUint32(0),c.getUint32(4),c.getUint32(8),c.getUint32(12)]),e.key.iv=e.key.iv||new Uint32Array([0,0,0,t.mediaIndex+t.playlist.mediaSequence]),this.pendingSegment_=t,r=this.hls_.xhr({uri:t.uri,responseType:"arraybuffer",withCredentials:this.withCredentials_,timeout:i,headers:S(e)},this.handleResponse_.bind(this)),this.xhr_={keyXhr:n,segmentXhr:r,abort:function(){if(this.segmentXhr)this.segmentXhr.onreadystatechange=null,this.segmentXhr.abort(),this.segmentXhr=null;if(this.keyXhr)this.keyXhr.onreadystatechange=null,this.keyXhr.abort(),this.keyXhr=null}},this.state="WAITING"}},{key:"handleResponse_",value:function(t,e){var i=void 0,n=void 0,r=void 0;if(this.xhr_&&(e===this.xhr_.segmentXhr||e===this.xhr_.keyXhr)){if(i=this.pendingSegment_,n=i.playlist.segments[i.mediaIndex],e.timedout)return this.abort_(),this.bandwidth=1,this.roundTrip=NaN,this.state="READY",this.trigger("progress");if(!e.aborted&&t)return r=this.xhr_.keyXhr,this.abort_(),this.error({status:e.status,message:e===r?"HLS key request error at URL: "+n.key.uri:"HLS segment request error at URL: "+i.uri,code:2,xhr:e}),this.state="READY",this.pause(),this.trigger("error");if(!e.response)return void this.abort_();if(e===this.xhr_.segmentXhr)if(this.xhr_.segmentXhr=null,this.roundTrip=e.roundTripTime,this.bandwidth=e.bandwidth,this.mediaBytesTransferred+=e.bytesReceived||0,this.mediaRequests+=1,this.mediaTransferDuration+=e.roundTripTime||0,n.key)i.encryptedBytes=new Uint8Array(e.response);else i.bytes=new Uint8Array(e.response);if(!this.xhr_.segmentXhr&&!this.xhr_.keyXhr)this.xhr_=null,this.processResponse_()}}},{key:"clearBuffer",value:function(){if(this.sourceUpdater_&&this.sourceUpdater_.buffered().length)this.sourceUpdater_.remove(0,1/0)}},{key:"processResponse_",value:function(){var t=void 0,e=void 0;if(this.state="DECRYPTING",t=this.pendingSegment_,e=t.playlist.segments[t.mediaIndex],e.key)new g.Decrypter(t.encryptedBytes,e.key.bytes,e.key.iv,function(e,i){t.bytes=i,this.handleSegment_()}.bind(this));else this.handleSegment_()}},{key:"handleSegment_",value:function(){var t=void 0;if(this.state="APPENDING",t=this.pendingSegment_,t.buffered=this.sourceUpdater_.buffered(),this.currentTimeline_=t.timeline,t.timestampOffset!==this.sourceUpdater_.timestampOffset())this.sourceUpdater_.timestampOffset(t.timestampOffset);this.sourceUpdater_.appendBuffer(t.bytes,this.handleUpdateEnd_.bind(this))}},{key:"handleUpdateEnd_",value:function(){var t=this.pendingSegment_,e=this.currentTime_();this.pendingSegment_=null;var i=this.updateTimeline_(t);this.trigger("progress");var n=t.mediaIndex;n+=t.playlist.mediaSequence-this.playlist_.mediaSequence;var r=u.default.findRange(this.sourceUpdater_.buffered(),e),o=T(t.playlist,this.mediaSource_,n,r);if(o)this.mediaSource_.endOfStream();var s=this.seekable_(),a=u.default.findNextRange(this.sourceUpdater_.buffered(),e);if(this.seeking_()&&0===r.length)if(s.length&&e<s.start(0))if(a.length)p.default.log("tried seeking to",e,"but that was too early, retrying at",a.start(0)),this.setCurrentTime_(a.start(0)+u.default.TIME_FUDGE_FACTOR);if(this.state="READY",!i){var l=this.incrementTimeCorrection_(t.duration,4);if(l&&!this.paused())this.fillBuffer_()}else if(this.timeCorrection_=0,!this.paused())this.fillBuffer_()}},{key:"updateTimeline_",value:function(t){var e=void 0,i=void 0,n=!1,r=t.playlist,o=t.mediaIndex;if(o+=r.mediaSequence-this.playlist_.mediaSequence,e=r.segments[o],e&&t&&t.playlist.uri===this.playlist_.uri)i=u.default.findSoleUncommonTimeRangesEnd(t.buffered,this.sourceUpdater_.buffered()),n=x(r,o,i);return n}},{key:"incrementTimeCorrection_",value:function(t,e){if(this.timeCorrection_>=this.playlist_.targetDuration*e)return this.timeCorrection_=0,!1;else return this.timeCorrection_+=t,!0}}]),e}(p.default.EventTarget);i.default=j,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./bin-utils":1,"./config":2,"./playlist":7,"./ranges":8,"./source-updater":12,"aes-decrypter":18}],12:[function(t,e,i){(function(t){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),s="undefined"!=typeof window?window.videojs:"undefined"!=typeof t?t.videojs:null,a=n(s),l=function(){function t(e,i){var n=this;r(this,t);var o=function(){n.sourceBuffer_=e.addSourceBuffer(i),n.onUpdateendCallback_=function(){var t=n.pendingCallback_;if(n.pendingCallback_=null,t)t();n.runCallback_()},n.sourceBuffer_.addEventListener("updateend",n.onUpdateendCallback_),n.runCallback_()};if(this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=e,"closed"===e.readyState)e.addEventListener("sourceopen",o);else o()}return o(t,[{key:"abort",value:function(t){var e=this;this.queueCallback_(function(){e.sourceBuffer_.abort()},t)}},{key:"appendBuffer",value:function(t,e){var i=this;this.queueCallback_(function(){i.sourceBuffer_.appendBuffer(t)},e)}},{key:"buffered",value:function(){if(!this.sourceBuffer_)return a.default.createTimeRanges();else return this.sourceBuffer_.buffered}},{key:"duration",value:function(t){var e=this;this.queueCallback_(function(){e.sourceBuffer_.duration=t})}},{key:"remove",value:function(t,e){var i=this;this.queueCallback_(function(){i.sourceBuffer_.remove(t,e)})}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating}},{key:"timestampOffset",value:function(t){var e=this;if("undefined"!=typeof t)this.queueCallback_(function(){e.sourceBuffer_.timestampOffset=t}),this.timestampOffset_=t;return this.timestampOffset_}},{key:"queueCallback_",value:function(t,e){this.callbacks_.push([t.bind(this),e]),this.runCallback_()}},{key:"runCallback_",value:function(){var t=void 0;if(this.sourceBuffer_&&!this.sourceBuffer_.updating&&this.callbacks_.length)t=this.callbacks_.shift(),this.pendingCallback_=t[1],t[0]()}},{key:"dispose",value:function(){if(this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_&&"open"===this.mediaSource.readyState)this.sourceBuffer_.abort()}}]),t}();i.default=l,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),o=function(){function t(){n(this,t),this.listeners={}}return r(t,[{key:"on",value:function(t,e){if(!this.listeners[t])this.listeners[t]=[];this.listeners[t].push(e)}},{key:"off",value:function(t,e){var i=void 0;if(!this.listeners[t])return!1;else return i=this.listeners[t].indexOf(e),this.listeners[t].splice(i,1),i>-1}},{key:"trigger",value:function(t){var e=void 0,i=void 0,n=void 0,r=void 0;if(e=this.listeners[t])if(2===arguments.length)for(n=e.length,i=0;i<n;++i)e[i].call(this,arguments[1]);else for(r=Array.prototype.slice.call(arguments,1),n=e.length,i=0;i<n;++i)e[i].apply(this,r)}},{key:"dispose",value:function(){this.listeners={}}},{key:"pipe",value:function(t){this.on("data",function(e){t.push(e)})}}]),t}();i.default=o,e.exports=i.default},{}],14:[function(t,e,i){(function(t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n="undefined"!=typeof window?window.videojs:"undefined"!=typeof t?t.videojs:null,r=function(){var t=function t(e,i){if(e=(0,n.mergeOptions)({timeout:45e3},e),t.beforeRequest&&"function"==typeof t.beforeRequest){var r=t.beforeRequest(e);if(r)e=r}var o=(0,n.xhr)(e,function(t,e){if(!t&&o.response)if(o.responseTime=(new Date).getTime(),o.roundTripTime=o.responseTime-o.requestTime,o.bytesReceived=o.response.byteLength||o.response.length,!o.bandwidth)o.bandwidth=Math.floor(o.bytesReceived/o.roundTripTime*8*1e3);if(t||o.timedout)o.timedout=o.timedout||"ETIMEDOUT"===t.code;else o.timedout=!1;if(!t&&200!==e.statusCode&&206!==e.statusCode&&0!==e.statusCode)t=new Error("XHR Failed with a response of: "+(o&&(o.response||o.responseText)));i(t,o)});return o.requestTime=(new Date).getTime(),o};return t};i.default=r,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),o=function(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]],e=t[0],i=t[1],n=e[4],r=i[4],o=void 0,s=void 0,a=void 0,l=[],c=[],u=void 0,d=void 0,h=void 0,p=void 0,f=void 0,m=void 0;for(o=0;o<256;o++)c[(l[o]=o<<1^283*(o>>7))^o]=o;for(s=a=0;!n[s];s^=u||1,a=c[a]||1)for(p=a^a<<1^a<<2^a<<3^a<<4,p=p>>8^255&p^99,n[s]=p,r[p]=s,h=l[d=l[u=l[s]]],m=16843009*h^65537*d^257*u^16843008*s,f=257*l[p]^16843008*p,o=0;o<4;o++)e[o][s]=f=f<<24^f>>>8,i[o][p]=m=m<<24^m>>>8;for(o=0;o<5;o++)e[o]=e[o].slice(0),i[o]=i[o].slice(0);return t},s=null,a=function(){function t(e){if(n(this,t),!s)s=o();this._tables=[[s[0][0].slice(),s[0][1].slice(),s[0][2].slice(),s[0][3].slice(),s[0][4].slice()],[s[1][0].slice(),s[1][1].slice(),s[1][2].slice(),s[1][3].slice(),s[1][4].slice()]];var i=void 0,r=void 0,a=void 0,l=void 0,c=void 0,u=this._tables[0][4],d=this._tables[1],h=e.length,p=1;if(4!==h&&6!==h&&8!==h)throw new Error("Invalid aes key size");for(l=e.slice(0),c=[],this._key=[l,c],i=h;i<4*h+28;i++){if(a=l[i-1],i%h===0||8===h&&i%h===4)if(a=u[a>>>24]<<24^u[a>>16&255]<<16^u[a>>8&255]<<8^u[255&a],i%h===0)a=a<<8^a>>>24^p<<24,p=p<<1^283*(p>>7);l[i]=l[i-h]^a}for(r=0;i;r++,i--)if(a=l[3&r?i:i-4],i<=4||r<4)c[r]=a;else c[r]=d[0][u[a>>>24]]^d[1][u[a>>16&255]]^d[2][u[a>>8&255]]^d[3][u[255&a]]}return r(t,[{key:"decrypt",value:function(t,e,i,n,r,o){var s=this._key[1],a=t^s[0],l=n^s[1],c=i^s[2],u=e^s[3],d=void 0,h=void 0,p=void 0,f=s.length/4-2,m=void 0,g=4,y=this._tables[1],v=y[0],b=y[1],_=y[2],w=y[3],x=y[4];for(m=0;m<f;m++)d=v[a>>>24]^b[l>>16&255]^_[c>>8&255]^w[255&u]^s[g],h=v[l>>>24]^b[c>>16&255]^_[u>>8&255]^w[255&a]^s[g+1],p=v[c>>>24]^b[u>>16&255]^_[a>>8&255]^w[255&l]^s[g+2],u=v[u>>>24]^b[a>>16&255]^_[l>>8&255]^w[255&c]^s[g+3],g+=4,a=d,l=h,c=p;for(m=0;m<4;m++)r[(3&-m)+o]=x[a>>>24]<<24^x[l>>16&255]<<16^x[c>>8&255]<<8^x[255&u]^s[g++],d=a,a=l,l=c,c=u,u=d}}]),t}();i.default=a,e.exports=i.default},{}],16:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),a=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},l=t("./stream"),c=n(l),u=function(t){function e(){r(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,c.default),this.jobs=[],this.delay=1,this.timeout_=null}return o(e,t),s(e,[{key:"processJob_",value:function(){if(this.jobs.shift()(),this.jobs.length)this.timeout_=setTimeout(this.processJob_.bind(this),this.delay);else this.timeout_=null}},{key:"push",value:function(t){if(this.jobs.push(t),!this.timeout_)this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}}]),e}(c.default);i.default=u,e.exports=i.default},{"./stream":19}],17:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),s=t("./aes"),a=n(s),l=t("./async-stream"),c=n(l),u=t("pkcs7"),d=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},h=function(t,e,i){var n=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2),r=new a.default(Array.prototype.slice.call(e)),o=new Uint8Array(t.byteLength),s=new Int32Array(o.buffer),l=void 0,c=void 0,u=void 0,h=void 0,p=void 0,f=void 0,m=void 0,g=void 0,y=void 0;for(l=i[0],c=i[1],u=i[2],h=i[3],y=0;y<n.length;y+=4)p=d(n[y]),f=d(n[y+1]),m=d(n[y+2]),g=d(n[y+3]),r.decrypt(p,f,m,g,s,y),s[y]=d(s[y]^l),s[y+1]=d(s[y+1]^c),s[y+2]=d(s[y+2]^u),s[y+3]=d(s[y+3]^h),l=p,c=f,u=m,h=g;return o};i.decrypt=h;var p=function(){function t(e,i,n,o){r(this,t);var s=t.STEP,a=new Int32Array(e.buffer),l=new Uint8Array(e.byteLength),h=0;for(this.asyncStream_=new c.default,this.asyncStream_.push(this.decryptChunk_(a.subarray(h,h+s),i,n,l)),h=s;h<a.length;h+=s)n=new Uint32Array([d(a[h-4]),d(a[h-3]),d(a[h-2]),d(a[h-1])]),this.asyncStream_.push(this.decryptChunk_(a.subarray(h,h+s),i,n,l));this.asyncStream_.push(function(){o(null,(0,u.unpad)(l))})}return o(t,[{key:"decryptChunk_",value:function(t,e,i,n){return function(){var r=h(t,e,i);n.set(r,t.byteOffset)}}}],[{key:"STEP",get:function(){return 32e3}}]),t}();i.Decrypter=p,i.default={Decrypter:p,decrypt:h}},{"./aes":15,"./async-stream":16,pkcs7:83}],18:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var r=t("./decrypter"),o=t("./async-stream"),s=n(o);i.default={decrypt:r.decrypt,Decrypter:r.Decrypter,AsyncStream:s.default},e.exports=i.default},{"./async-stream":16,"./decrypter":17}],19:[function(t,e,i){arguments[4][13][0].apply(i,arguments)},{dup:13}],20:[function(t,e,i){},{}],21:[function(t,e,i){var n={utf8:{stringToBytes:function(t){return n.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(n.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],i=0;i<t.length;i++)e.push(255&t.charCodeAt(i));return e},bytesToString:function(t){for(var e=[],i=0;i<t.length;i++)e.push(String.fromCharCode(t[i]));return e.join("")}}};e.exports=n},{}],22:[function(t,e,i){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&i.rotl(t,8)|4278255360&i.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=i.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],i=0,n=0;i<t.length;i++,n+=8)e[n>>>5]|=t[i]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],i=0;i<32*t.length;i+=8)e.push(t[i>>>5]>>>24-i%32&255);return e},bytesToHex:function(t){for(var e=[],i=0;i<t.length;i++)e.push((t[i]>>>4).toString(16)),e.push((15&t[i]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],i=0;i<t.length;i+=2)e.push(parseInt(t.substr(i,2),16));return e},bytesToBase64:function(e){for(var i=[],n=0;n<e.length;n+=3)for(var r=e[n]<<16|e[n+1]<<8|e[n+2],o=0;o<4;o++)if(8*n+6*o<=8*e.length)i.push(t.charAt(r>>>6*(3-o)&63));else i.push("=");return i.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var i=[],n=0,r=0;n<e.length;r=++n%4)if(0!=r)i.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*r+8)-1)<<2*r|t.indexOf(e.charAt(n))>>>6-2*r);else;return i}};e.exports=i}()},{}],23:[function(t,e,i){(function(i){var n="undefined"!=typeof i?i:"undefined"!=typeof window?window:{},r=t("min-document");if("undefined"!=typeof document)e.exports=document;else{var o=n["__GLOBAL_DOCUMENT_CACHE@4"];if(!o)o=n["__GLOBAL_DOCUMENT_CACHE@4"]=r;e.exports=o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":20}],24:[function(t,e,i){e.exports=function(t){return!(null==t||!(t._isBuffer||t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)))}},{}],25:[function(t,e,i){function n(t,e){if("function"!=typeof t)throw new TypeError(r);return e=o(void 0===e?t.length-1:+e||0,0),function(){for(var i=arguments,n=-1,r=o(i.length-e,0),s=Array(r);++n<r;)s[n]=i[e+n];switch(e){case 0:return t.call(this,s);case 1:return t.call(this,i[0],s);case 2:return t.call(this,i[0],i[1],s)}var a=Array(e+1);for(n=-1;++n<e;)a[n]=i[n];return a[e]=s,t.apply(this,a)}}var r="Expected a function",o=Math.max;e.exports=n},{}],26:[function(t,e,i){function n(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}e.exports=n},{}],27:[function(t,e,i){function n(t,e){for(var i=-1,n=t.length;++i<n&&e(t[i],i,t)!==!1;);return t}e.exports=n},{}],28:[function(t,e,i){function n(t,e,i){i||(i={});for(var n=-1,r=e.length;++n<r;){var o=e[n];i[o]=t[o]}return i}e.exports=n},{}],29:[function(t,e,i){var n=t("./createBaseFor"),r=n();e.exports=r},{"./createBaseFor":36}],30:[function(t,e,i){function n(t,e){return r(t,e,o)}var r=t("./baseFor"),o=t("../object/keysIn");e.exports=n},{"../object/keysIn":57,"./baseFor":29}],31:[function(t,e,i){function n(t,e,i,h,p){if(!l(t))return t;var f=a(e)&&(s(e)||u(e)),m=f?void 0:d(e);return r(m||e,function(r,s){if(m)s=r,r=e[s];if(c(r))h||(h=[]),p||(p=[]),o(t,e,s,n,i,h,p);else{var a=t[s],l=i?i(a,r,s,t,e):void 0,u=void 0===l;if(u)l=r;if((void 0!==l||f&&!(s in t))&&(u||(l===l?l!==a:a===a)))t[s]=l}}),t}var r=t("./arrayEach"),o=t("./baseMergeDeep"),s=t("../lang/isArray"),a=t("./isArrayLike"),l=t("../lang/isObject"),c=t("./isObjectLike"),u=t("../lang/isTypedArray"),d=t("../object/keys");e.exports=n},{"../lang/isArray":48,"../lang/isObject":51,"../lang/isTypedArray":54,"../object/keys":56,"./arrayEach":27,"./baseMergeDeep":32,"./isArrayLike":39,"./isObjectLike":44}],32:[function(t,e,i){function n(t,e,i,n,d,h,p){for(var f=h.length,m=e[i];f--;)if(h[f]==m)return void(t[i]=p[f]);var g=t[i],y=d?d(g,m,i,t,e):void 0,v=void 0===y;if(v)if(y=m,a(m)&&(s(m)||c(m)))y=s(g)?g:a(g)?r(g):[];else if(l(m)||o(m))y=o(g)?u(g):l(g)?g:{};else v=!1;if(h.push(m),p.push(y),v)t[i]=n(y,m,d,h,p);else if(y===y?y!==g:g===g)t[i]=y}var r=t("./arrayCopy"),o=t("../lang/isArguments"),s=t("../lang/isArray"),a=t("./isArrayLike"),l=t("../lang/isPlainObject"),c=t("../lang/isTypedArray"),u=t("../lang/toPlainObject");e.exports=n},{"../lang/isArguments":47,"../lang/isArray":48,"../lang/isPlainObject":52,"../lang/isTypedArray":54,"../lang/toPlainObject":55,"./arrayCopy":26,"./isArrayLike":39}],33:[function(t,e,i){function n(t){return function(e){return null==e?void 0:r(e)[t]}}var r=t("./toObject");e.exports=n},{"./toObject":46}],34:[function(t,e,i){function n(t,e,i){if("function"!=typeof t)return r;if(void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,o){return t.call(e,i,n,r,o)};case 5:return function(i,n,r,o,s){return t.call(e,i,n,r,o,s)}}return function(){return t.apply(e,arguments)}}var r=t("../utility/identity");e.exports=n},{"../utility/identity":60}],35:[function(t,e,i){function n(t){return s(function(e,i){var n=-1,s=null==e?0:i.length,a=s>2?i[s-2]:void 0,l=s>2?i[2]:void 0,c=s>1?i[s-1]:void 0;if("function"==typeof a)a=r(a,c,5),s-=2;else a="function"==typeof c?c:void 0,s-=a?1:0;if(l&&o(i[0],i[1],l))a=s<3?void 0:a,s=1;for(;++n<s;){var u=i[n];if(u)t(e,u,a)}return e})}var r=t("./bindCallback"),o=t("./isIterateeCall"),s=t("../function/restParam");e.exports=n},{"../function/restParam":25,"./bindCallback":34,"./isIterateeCall":42}],36:[function(t,e,i){function n(t){return function(e,i,n){for(var o=r(e),s=n(e),a=s.length,l=t?a:-1;t?l--:++l<a;){var c=s[l];if(i(o[c],c,o)===!1)break}return e}}var r=t("./toObject");e.exports=n},{"./toObject":46}],37:[function(t,e,i){var n=t("./baseProperty"),r=n("length");e.exports=r},{"./baseProperty":33}],38:[function(t,e,i){function n(t,e){var i=null==t?void 0:t[e];return r(i)?i:void 0}var r=t("../lang/isNative");e.exports=n},{"../lang/isNative":50}],39:[function(t,e,i){function n(t){return null!=t&&o(r(t))}var r=t("./getLength"),o=t("./isLength");e.exports=n},{"./getLength":37,"./isLength":43}],40:[function(t,e,i){var n=function(){try{Object({toString:0}+"")}catch(t){return function(){return!1}}return function(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}}();e.exports=n},{}],41:[function(t,e,i){function n(t,e){return t="number"==typeof t||r.test(t)?+t:-1,e=null==e?o:e,t>-1&&t%1==0&&t<e}var r=/^\d+$/,o=9007199254740991;e.exports=n},{}],42:[function(t,e,i){function n(t,e,i){if(!s(i))return!1;var n=typeof e;if("number"==n?r(i)&&o(e,i.length):"string"==n&&e in i){var a=i[e];return t===t?t===a:a!==a}return!1}var r=t("./isArrayLike"),o=t("./isIndex"),s=t("../lang/isObject");e.exports=n},{"../lang/isObject":51,"./isArrayLike":39,"./isIndex":41}],43:[function(t,e,i){function n(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}var r=9007199254740991;e.exports=n},{}],44:[function(t,e,i){function n(t){return!!t&&"object"==typeof t}e.exports=n},{}],45:[function(t,e,i){function n(t){for(var e=c(t),i=e.length,n=i&&t.length,u=!!n&&a(n)&&(o(t)||r(t)||l(t)),h=-1,p=[];++h<i;){var f=e[h];if(u&&s(f,n)||d.call(t,f))p.push(f)}return p}var r=t("../lang/isArguments"),o=t("../lang/isArray"),s=t("./isIndex"),a=t("./isLength"),l=t("../lang/isString"),c=t("../object/keysIn"),u=Object.prototype,d=u.hasOwnProperty;e.exports=n},{"../lang/isArguments":47,"../lang/isArray":48,"../lang/isString":53,"../object/keysIn":57,"./isIndex":41,"./isLength":43}],46:[function(t,e,i){function n(t){if(s.unindexedChars&&o(t)){for(var e=-1,i=t.length,n=Object(t);++e<i;)n[e]=t.charAt(e);return n}return r(t)?t:Object(t)}var r=t("../lang/isObject"),o=t("../lang/isString"),s=t("../support");e.exports=n},{"../lang/isObject":51,"../lang/isString":53,"../support":59}],47:[function(t,e,i){function n(t){return o(t)&&r(t)&&a.call(t,"callee")&&!l.call(t,"callee")}var r=t("../internal/isArrayLike"),o=t("../internal/isObjectLike"),s=Object.prototype,a=s.hasOwnProperty,l=s.propertyIsEnumerable;e.exports=n},{"../internal/isArrayLike":39,"../internal/isObjectLike":44}],48:[function(t,e,i){var n=t("../internal/getNative"),r=t("../internal/isLength"),o=t("../internal/isObjectLike"),s="[object Array]",a=Object.prototype,l=a.toString,c=n(Array,"isArray"),u=c||function(t){return o(t)&&r(t.length)&&l.call(t)==s};e.exports=u},{"../internal/getNative":38,"../internal/isLength":43,"../internal/isObjectLike":44}],49:[function(t,e,i){function n(t){return r(t)&&a.call(t)==o}var r=t("./isObject"),o="[object Function]",s=Object.prototype,a=s.toString;e.exports=n},{"./isObject":51}],50:[function(t,e,i){function n(t){if(null==t)return!1;if(r(t))return d.test(c.call(t));else return s(t)&&(o(t)?d:a).test(t)}var r=t("./isFunction"),o=t("../internal/isHostObject"),s=t("../internal/isObjectLike"),a=/^\[object .+?Constructor\]$/,l=Object.prototype,c=Function.prototype.toString,u=l.hasOwnProperty,d=RegExp("^"+c.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=n},{"../internal/isHostObject":40,"../internal/isObjectLike":44,"./isFunction":49}],51:[function(t,e,i){function n(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=n},{}],52:[function(t,e,i){function n(t){var e;if(!a(t)||h.call(t)!=c||s(t)||o(t)||!d.call(t,"constructor")&&(e=t.constructor,"function"==typeof e&&!(e instanceof e)))return!1;var i;if(l.ownLast)return r(t,function(t,e,n){return i=d.call(n,e),!1}),i!==!1;else return r(t,function(t,e){i=e}),void 0===i||d.call(t,i)}var r=t("../internal/baseForIn"),o=t("./isArguments"),s=t("../internal/isHostObject"),a=t("../internal/isObjectLike"),l=t("../support"),c="[object Object]",u=Object.prototype,d=u.hasOwnProperty,h=u.toString;e.exports=n},{"../internal/baseForIn":30,"../internal/isHostObject":40,"../internal/isObjectLike":44,"../support":59,"./isArguments":47}],53:[function(t,e,i){function n(t){return"string"==typeof t||r(t)&&a.call(t)==o}var r=t("../internal/isObjectLike"),o="[object String]",s=Object.prototype,a=s.toString;e.exports=n},{"../internal/isObjectLike":44}],54:[function(t,e,i){function n(t){return o(t)&&r(t.length)&&!!C[M.call(t)]}var r=t("../internal/isLength"),o=t("../internal/isObjectLike"),s="[object Arguments]",a="[object Array]",l="[object Boolean]",c="[object Date]",u="[object Error]",d="[object Function]",h="[object Map]",p="[object Number]",f="[object Object]",m="[object RegExp]",g="[object Set]",y="[object String]",v="[object WeakMap]",b="[object ArrayBuffer]",_="[object Float32Array]",w="[object Float64Array]",x="[object Int8Array]",T="[object Int16Array]",k="[object Int32Array]",S="[object Uint8Array]",j="[object Uint8ClampedArray]",E="[object Uint16Array]",P="[object Uint32Array]",C={};
C[_]=C[w]=C[x]=C[T]=C[k]=C[S]=C[j]=C[E]=C[P]=!0,C[s]=C[a]=C[b]=C[l]=C[c]=C[u]=C[d]=C[h]=C[p]=C[f]=C[m]=C[g]=C[y]=C[v]=!1;var O=Object.prototype,M=O.toString;e.exports=n},{"../internal/isLength":43,"../internal/isObjectLike":44}],55:[function(t,e,i){function n(t){return r(t,o(t))}var r=t("../internal/baseCopy"),o=t("../object/keysIn");e.exports=n},{"../internal/baseCopy":28,"../object/keysIn":57}],56:[function(t,e,i){var n=t("../internal/getNative"),r=t("../internal/isArrayLike"),o=t("../lang/isObject"),s=t("../internal/shimKeys"),a=t("../support"),l=n(Object,"keys"),c=!l?s:function(t){var e=null==t?void 0:t.constructor;if("function"==typeof e&&e.prototype===t||("function"==typeof t?a.enumPrototypes:r(t)))return s(t);else return o(t)?l(t):[]};e.exports=c},{"../internal/getNative":38,"../internal/isArrayLike":39,"../internal/shimKeys":45,"../lang/isObject":51,"../support":59}],57:[function(t,e,i){function n(t){if(null==t)return[];if(!u(t))t=Object(t);var e=t.length;e=e&&c(e)&&(s(t)||o(t)||d(t))&&e||0;for(var i=t.constructor,n=-1,r=a(i)&&i.prototype||k,p=r===t,f=Array(e),m=e>0,y=h.enumErrorProps&&(t===T||t instanceof Error),v=h.enumPrototypes&&a(t);++n<e;)f[n]=n+"";for(var _ in t)if((!v||"prototype"!=_)&&(!y||"message"!=_&&"name"!=_)&&(!m||!l(_,e))&&("constructor"!=_||!p&&j.call(t,_)))f.push(_);if(h.nonEnumShadows&&t!==k){var C=t===S?w:t===T?g:E.call(t),O=P[C]||P[b];if(C==b)r=k;for(e=x.length;e--;){_=x[e];var M=O[_];if((!p||!M)&&(M?j.call(t,_):t[_]!==r[_]))f.push(_)}}return f}var r=t("../internal/arrayEach"),o=t("../lang/isArguments"),s=t("../lang/isArray"),a=t("../lang/isFunction"),l=t("../internal/isIndex"),c=t("../internal/isLength"),u=t("../lang/isObject"),d=t("../lang/isString"),h=t("../support"),p="[object Array]",f="[object Boolean]",m="[object Date]",g="[object Error]",y="[object Function]",v="[object Number]",b="[object Object]",_="[object RegExp]",w="[object String]",x=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],T=Error.prototype,k=Object.prototype,S=String.prototype,j=k.hasOwnProperty,E=k.toString,P={};P[p]=P[m]=P[v]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},P[f]=P[w]={constructor:!0,toString:!0,valueOf:!0},P[g]=P[y]=P[_]={constructor:!0,toString:!0},P[b]={constructor:!0},r(x,function(t){for(var e in P)if(j.call(P,e)){var i=P[e];i[t]=j.call(i,t)}}),e.exports=n},{"../internal/arrayEach":27,"../internal/isIndex":41,"../internal/isLength":43,"../lang/isArguments":47,"../lang/isArray":48,"../lang/isFunction":49,"../lang/isObject":51,"../lang/isString":53,"../support":59}],58:[function(t,e,i){var n=t("../internal/baseMerge"),r=t("../internal/createAssigner"),o=r(n);e.exports=o},{"../internal/baseMerge":31,"../internal/createAssigner":35}],59:[function(t,e,i){var n=Array.prototype,r=Error.prototype,o=Object.prototype,s=o.propertyIsEnumerable,a=n.splice,l={};!function(t){var e=function(){this.x=t},i={0:t,length:t},n=[];e.prototype={valueOf:t,y:t};for(var o in new e)n.push(o);l.enumErrorProps=s.call(r,"message")||s.call(r,"name"),l.enumPrototypes=s.call(e,"prototype"),l.nonEnumShadows=!/valueOf/.test(n),l.ownLast="x"!=n[0],l.spliceObjects=(a.call(i,0,1),!i[0]),l.unindexedChars="x"[0]+Object("x")[0]!="xx"}(1,0),e.exports=l},{}],60:[function(t,e,i){function n(t){return t}e.exports=n},{}],61:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var r=t("./line-stream"),o=n(r),s=t("./parse-stream"),a=n(s),l=t("./parser"),c=n(l);i.default={LineStream:o.default,ParseStream:a.default,Parser:c.default},e.exports=i.default},{"./line-stream":62,"./parse-stream":63,"./parser":64}],62:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),a=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},l=t("./stream"),c=n(l),u=function(t){function e(){r(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.buffer=""}return o(e,t),s(e,[{key:"push",value:function(t){var e=void 0;for(this.buffer+=t,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)}}]),e}(c.default);i.default=u,e.exports=i.default},{"./stream":65}],63:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{if(!n&&a.return)a.return()}finally{if(r)throw o}}return i}return function(e,i){if(Array.isArray(e))return e;else if(Symbol.iterator in Object(e))return t(e,i);else throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),l=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},c=t("./stream"),u=n(c),d=function(){var t="[^=]*",e='"[^"]*"|[^,]*',i="(?:"+t+")=(?:"+e+")";return new RegExp("(?:^|,)("+i+")")},h=function(t){for(var e=t.split(d()),i=e.length,n={},r=void 0;i--;)if(""!==e[i])r=/([^=]*)=(.*)/.exec(e[i]).slice(1),r[0]=r[0].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1"),n[r[0]]=r[1];else;return n},p=function(t){function e(){r(this,e),l(Object.getPrototypeOf(e.prototype),"constructor",this).call(this)}return o(e,t),a(e,[{key:"push",value:function(t){var e=void 0,i=void 0;if(t=t.replace(/^[\u0000\s]+|[\u0000\s]+$/g,""),0!==t.length){if("#"!==t[0])return void this.trigger("data",{type:"uri",uri:t});if(0!==t.indexOf("#EXT"))return void this.trigger("data",{type:"comment",text:t.slice(1)});if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t))return void this.trigger("data",{type:"tag",tagType:"m3u"});if(e=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t)){if(i={type:"tag",tagType:"inf"},e[1])i.duration=parseFloat(e[1]);if(e[2])i.title=e[2];return void this.trigger("data",i)}if(e=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t)){if(i={type:"tag",tagType:"targetduration"},e[1])i.duration=parseInt(e[1],10);return void this.trigger("data",i)}if(e=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t)){if(i={type:"tag",tagType:"totalduration"},e[1])i.duration=parseInt(e[1],10);return void this.trigger("data",i)}if(e=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t)){if(i={type:"tag",tagType:"version"},e[1])i.version=parseInt(e[1],10);return void this.trigger("data",i)}if(e=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t)){if(i={type:"tag",tagType:"media-sequence"},e[1])i.number=parseInt(e[1],10);return void this.trigger("data",i)}if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t)){if(i={type:"tag",tagType:"discontinuity-sequence"},e[1])i.number=parseInt(e[1],10);return void this.trigger("data",i)}if(e=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t)){if(i={type:"tag",tagType:"playlist-type"},e[1])i.playlistType=e[1];return void this.trigger("data",i)}if(e=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t)){if(i={type:"tag",tagType:"byterange"},e[1])i.length=parseInt(e[1],10);if(e[2])i.offset=parseInt(e[2],10);return void this.trigger("data",i)}if(e=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t)){if(i={type:"tag",tagType:"allow-cache"},e[1])i.allowed=!/NO/.test(e[1]);return void this.trigger("data",i)}if(e=/^#EXT-X-MAP:?(.*)$/.exec(t)){if(i={type:"tag",tagType:"map"},e[1]){var n=h(e[1]);if(n.URI)i.uri=n.URI;if(n.BYTERANGE){var r=n.BYTERANGE.split("@"),o=s(r,2),a=o[0],l=o[1];if(i.byterange={},a)i.byterange.length=parseInt(a,10);if(l)i.byterange.offset=parseInt(l,10)}}return void this.trigger("data",i)}if(e=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t)){if(i={type:"tag",tagType:"stream-inf"},e[1]){if(i.attributes=h(e[1]),i.attributes.RESOLUTION){var c=i.attributes.RESOLUTION.split("x"),u={};if(c[0])u.width=parseInt(c[0],10);if(c[1])u.height=parseInt(c[1],10);i.attributes.RESOLUTION=u}if(i.attributes.BANDWIDTH)i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10);if(i.attributes["PROGRAM-ID"])i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10)}return void this.trigger("data",i)}if(e=/^#EXT-X-MEDIA:?(.*)$/.exec(t)){if(i={type:"tag",tagType:"media"},e[1])i.attributes=h(e[1]);return void this.trigger("data",i)}if(e=/^#EXT-X-ENDLIST/.exec(t))return void this.trigger("data",{type:"tag",tagType:"endlist"});if(e=/^#EXT-X-DISCONTINUITY/.exec(t))return void this.trigger("data",{type:"tag",tagType:"discontinuity"});if(e=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(t)){if(i={type:"tag",tagType:"date-time"},e[1])i.dateTimeString=e[1],i.dateTimeObject=new Date(e[1]);return void this.trigger("data",i)}if(e=/^#EXT-X-KEY:?(.*)$/.exec(t)){if(i={type:"tag",tagType:"key"},e[1])if(i.attributes=h(e[1]),i.attributes.IV){if("0x"===i.attributes.IV.substring(0,2).toLowerCase())i.attributes.IV=i.attributes.IV.substring(2);i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV)}return void this.trigger("data",i)}this.trigger("data",{type:"tag",data:t.slice(4,t.length)})}}}]),e}(u.default);i.default=p,e.exports=i.default},{"./stream":65}],64:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),a=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},l=t("./stream"),c=n(l),u=t("./line-stream"),d=n(u),h=t("./parse-stream"),p=n(h),f=t("lodash-compat/object/merge"),m=n(f),g=function(t){function e(){r(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.lineStream=new d.default,this.parseStream=new p.default,this.lineStream.pipe(this.parseStream);var t=this,i=[],n={},o=void 0,s=void 0,l=function(){},c={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},u=0;this.manifest={allowCache:!0,discontinuityStarts:[]},this.parseStream.on("data",function(e){var r=void 0,a=void 0;({tag:function(){(({"allow-cache":function(){if(this.manifest.allowCache=e.allowed,!("allowed"in e))this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0},byterange:function t(){var t={};if("length"in e)if(n.byterange=t,t.length=e.length,!("offset"in e))this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0;if("offset"in e)n.byterange=t,t.offset=e.offset},endlist:function(){this.manifest.endList=!0},inf:function(){if(!("mediaSequence"in this.manifest))this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"});if(!("discontinuitySequence"in this.manifest))this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"});if(e.duration>0)n.duration=e.duration;if(0===e.duration)n.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"});this.manifest.segments=i},key:function(){if(!e.attributes)return void this.trigger("warn",{message:"ignoring key declaration without attribute list"});if("NONE"===e.attributes.METHOD)return void(s=null);if(!e.attributes.URI)return void this.trigger("warn",{message:"ignoring key declaration without URI"});if(!e.attributes.METHOD)this.trigger("warn",{message:"defaulting key method to AES-128"});if(s={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},"undefined"!=typeof e.attributes.IV)s.iv=e.attributes.IV},"media-sequence":function(){if(!isFinite(e.number))return void this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number});else return void(this.manifest.mediaSequence=e.number)},"discontinuity-sequence":function(){if(!isFinite(e.number))return void this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number});else return this.manifest.discontinuitySequence=e.number,void(u=e.number)},"playlist-type":function(){if(!/VOD|EVENT/.test(e.playlistType))return void this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist});else return void(this.manifest.playlistType=e.playlistType)},map:function(){if(o={},e.uri)o.uri=e.uri;if(e.byterange)o.byterange=e.byterange},"stream-inf":function(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||c,!e.attributes)return void this.trigger("warn",{message:"ignoring empty stream-inf attributes"});if(!n.attributes)n.attributes={};n.attributes=(0,m.default)(n.attributes,e.attributes)},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||c,!(e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME))return void this.trigger("warn",{message:"ignoring incomplete or missing media group"});var t=this.manifest.mediaGroups[e.attributes.TYPE];if(t[e.attributes["GROUP-ID"]]=t[e.attributes["GROUP-ID"]]||{},r=t[e.attributes["GROUP-ID"]],a={default:/yes/i.test(e.attributes.DEFAULT)},a.default)a.autoselect=!0;else a.autoselect=/yes/i.test(e.attributes.AUTOSELECT);if(e.attributes.LANGUAGE)a.language=e.attributes.LANGUAGE;if(e.attributes.URI)a.uri=e.attributes.URI;if(e.attributes["INSTREAM-ID"])a.instreamId=e.attributes["INSTREAM-ID"];r[e.attributes.NAME]=a},discontinuity:function(){u+=1,n.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"date-time":function(){this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject},targetduration:function(){if(!isFinite(e.duration)||e.duration<0)return void this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration});else return void(this.manifest.targetDuration=e.duration)},totalduration:function(){if(!isFinite(e.duration)||e.duration<0)return void this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration});else return void(this.manifest.totalDuration=e.duration)}})[e.tagType]||l).call(t)},uri:function(){if(n.uri=e.uri,i.push(n),this.manifest.targetDuration&&!("duration"in n))this.trigger("warn",{message:"defaulting segment duration to the target duration"}),n.duration=this.manifest.targetDuration;if(s)n.key=s;if(n.timeline=u,o)n.map=o;n={}},comment:function(){}})[e.type].call(t)})}return o(e,t),s(e,[{key:"push",value:function(t){this.lineStream.push(t)}},{key:"end",value:function(){this.lineStream.push("\n")}}]),e}(c.default);i.default=g,e.exports=i.default},{"./line-stream":62,"./parse-stream":63,"./stream":65,"lodash-compat/object/merge":58}],65:[function(t,e,i){arguments[4][13][0].apply(i,arguments)},{dup:13}],66:[function(t,e,i){!function(){var i=t("crypt"),n=t("charenc").utf8,r=t("is-buffer"),o=t("charenc").bin,s=function(t,e){if(t.constructor==String)if(e&&"binary"===e.encoding)t=o.stringToBytes(t);else t=n.stringToBytes(t);else if(r(t))t=Array.prototype.slice.call(t,0);else if(!Array.isArray(t))t=t.toString();for(var a=i.bytesToWords(t),l=8*t.length,c=1732584193,u=-271733879,d=-1732584194,h=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[l>>>5]|=128<<l%32,a[(l+64>>>9<<4)+14]=l;for(var f=s._ff,m=s._gg,g=s._hh,y=s._ii,p=0;p<a.length;p+=16){var v=c,b=u,_=d,w=h;c=f(c,u,d,h,a[p+0],7,-680876936),h=f(h,c,u,d,a[p+1],12,-389564586),d=f(d,h,c,u,a[p+2],17,606105819),u=f(u,d,h,c,a[p+3],22,-1044525330),c=f(c,u,d,h,a[p+4],7,-176418897),h=f(h,c,u,d,a[p+5],12,1200080426),d=f(d,h,c,u,a[p+6],17,-1473231341),u=f(u,d,h,c,a[p+7],22,-45705983),c=f(c,u,d,h,a[p+8],7,1770035416),h=f(h,c,u,d,a[p+9],12,-1958414417),d=f(d,h,c,u,a[p+10],17,-42063),u=f(u,d,h,c,a[p+11],22,-1990404162),c=f(c,u,d,h,a[p+12],7,1804603682),h=f(h,c,u,d,a[p+13],12,-40341101),d=f(d,h,c,u,a[p+14],17,-1502002290),u=f(u,d,h,c,a[p+15],22,1236535329),c=m(c,u,d,h,a[p+1],5,-165796510),h=m(h,c,u,d,a[p+6],9,-1069501632),d=m(d,h,c,u,a[p+11],14,643717713),u=m(u,d,h,c,a[p+0],20,-373897302),c=m(c,u,d,h,a[p+5],5,-701558691),h=m(h,c,u,d,a[p+10],9,38016083),d=m(d,h,c,u,a[p+15],14,-660478335),u=m(u,d,h,c,a[p+4],20,-405537848),c=m(c,u,d,h,a[p+9],5,568446438),h=m(h,c,u,d,a[p+14],9,-1019803690),d=m(d,h,c,u,a[p+3],14,-187363961),u=m(u,d,h,c,a[p+8],20,1163531501),c=m(c,u,d,h,a[p+13],5,-1444681467),h=m(h,c,u,d,a[p+2],9,-51403784),d=m(d,h,c,u,a[p+7],14,1735328473),u=m(u,d,h,c,a[p+12],20,-1926607734),c=g(c,u,d,h,a[p+5],4,-378558),h=g(h,c,u,d,a[p+8],11,-2022574463),d=g(d,h,c,u,a[p+11],16,1839030562),u=g(u,d,h,c,a[p+14],23,-35309556),c=g(c,u,d,h,a[p+1],4,-1530992060),h=g(h,c,u,d,a[p+4],11,1272893353),d=g(d,h,c,u,a[p+7],16,-155497632),u=g(u,d,h,c,a[p+10],23,-1094730640),c=g(c,u,d,h,a[p+13],4,681279174),h=g(h,c,u,d,a[p+0],11,-358537222),d=g(d,h,c,u,a[p+3],16,-722521979),u=g(u,d,h,c,a[p+6],23,76029189),c=g(c,u,d,h,a[p+9],4,-640364487),h=g(h,c,u,d,a[p+12],11,-421815835),d=g(d,h,c,u,a[p+15],16,530742520),u=g(u,d,h,c,a[p+2],23,-995338651),c=y(c,u,d,h,a[p+0],6,-198630844),h=y(h,c,u,d,a[p+7],10,1126891415),d=y(d,h,c,u,a[p+14],15,-1416354905),u=y(u,d,h,c,a[p+5],21,-57434055),c=y(c,u,d,h,a[p+12],6,1700485571),h=y(h,c,u,d,a[p+3],10,-1894986606),d=y(d,h,c,u,a[p+10],15,-1051523),u=y(u,d,h,c,a[p+1],21,-2054922799),c=y(c,u,d,h,a[p+8],6,1873313359),h=y(h,c,u,d,a[p+15],10,-30611744),d=y(d,h,c,u,a[p+6],15,-1560198380),u=y(u,d,h,c,a[p+13],21,1309151649),c=y(c,u,d,h,a[p+4],6,-145523070),h=y(h,c,u,d,a[p+11],10,-1120210379),d=y(d,h,c,u,a[p+2],15,718787259),u=y(u,d,h,c,a[p+9],21,-343485551),c=c+v>>>0,u=u+b>>>0,d=d+_>>>0,h=h+w>>>0}return i.endian([c,u,d,h])};s._ff=function(t,e,i,n,r,o,s){var a=t+(e&i|~e&n)+(r>>>0)+s;return(a<<o|a>>>32-o)+e},s._gg=function(t,e,i,n,r,o,s){var a=t+(e&n|i&~n)+(r>>>0)+s;return(a<<o|a>>>32-o)+e},s._hh=function(t,e,i,n,r,o,s){var a=t+(e^i^n)+(r>>>0)+s;return(a<<o|a>>>32-o)+e},s._ii=function(t,e,i,n,r,o,s){var a=t+(i^(e|~n))+(r>>>0)+s;return(a<<o|a>>>32-o)+e},s._blocksize=16,s._digestsize=16,e.exports=function(t,e){if("undefined"!=typeof t){var n=i.wordsToBytes(s(t,e));return e&&e.asBytes?n:e&&e.asString?o.bytesToString(n):i.bytesToHex(n)}}}()},{charenc:21,crypt:22,"is-buffer":24}],67:[function(t,e,i){"use strict";var n,r=t("../utils/stream.js");n=function(){var t=new Uint8Array,e=0;n.prototype.init.call(this),this.setTimestamp=function(t){e=t},this.parseId3TagSize=function(t,e){var i=t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9],n=t[e+5],r=(16&n)>>4;if(r)return i+20;else return i+10},this.parseAdtsSize=function(t,e){var i=(224&t[e+5])>>5,n=t[e+4]<<3,r=6144&t[e+3];return r|n|i},this.push=function(i){var n,r,o,s,a=0,l=0;if(t.length)s=t.length,t=new Uint8Array(i.byteLength+s),t.set(t.subarray(0,s)),t.set(i,s);else t=i;for(;t.length-l>=3;)if(t[l]!=="I".charCodeAt(0)||t[l+1]!=="D".charCodeAt(0)||t[l+2]!=="3".charCodeAt(0)){if(t[l]&!0&&240===(240&t[l+1])){if(t.length-l<7)break;if(a=this.parseAdtsSize(t,l),a>t.length)break;o={type:"audio",data:t.subarray(l,l+a),pts:e,dts:e},this.trigger("data",o),l+=a;continue}l++}else{if(t.length-l<10)break;if(a=this.parseId3TagSize(t,l),a>t.length)break;r={type:"timed-metadata",data:t.subarray(l,l+a)},this.trigger("data",r),l+=a}if(n=t.length-l,n>0)t=t.subarray(l);else t=new Uint8Array}},n.prototype=new r,e.exports=n},{"../utils/stream.js":81}],68:[function(t,e,i){"use strict";var n,r=t("../utils/stream.js"),o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];n=function(){var t,e;n.prototype.init.call(this),t=this,this.push=function(t){var i,n,r,s,a,l,c=0,u=0;if("audio"===t.type){if(e)s=e,e=new Uint8Array(s.byteLength+t.data.byteLength),e.set(s),e.set(t.data,s.byteLength);else e=t.data;for(;c+5<e.length;)if(255===e[c]&&240===(246&e[c+1])){if(n=2*(1&~e[c+1]),i=(3&e[c+3])<<11|e[c+4]<<3|(224&e[c+5])>>5,a=1024*((3&e[c+6])+1),l=9e4*a/o[(60&e[c+2])>>>2],r=c+i,e.byteLength<r)return;if(this.trigger("data",{pts:t.pts+u*l,dts:t.dts+u*l,sampleCount:a,audioobjecttype:(e[c+2]>>>6&3)+1,channelcount:(1&e[c+2])<<2|(192&e[c+3])>>>6,samplerate:o[(60&e[c+2])>>>2],samplingfrequencyindex:(60&e[c+2])>>>2,samplesize:16,data:e.subarray(c+7+n,r)}),e.byteLength===r)return void(e=void 0);u++,e=e.subarray(r)}else c++}},this.flush=function(){this.trigger("done")}},n.prototype=new r,e.exports=n},{"../utils/stream.js":81}],69:[function(t,e,i){"use strict";var n,r,o=t("../utils/stream.js"),s=t("../utils/exp-golomb.js");r=function(){var t,e,i=0;r.prototype.init.call(this),this.push=function(n){var r;if(!e)e=n.data;else r=new Uint8Array(e.byteLength+n.data.byteLength),r.set(e),r.set(n.data,e.byteLength),e=r;for(;i<e.byteLength-3;i++)if(1===e[i+2]){t=i+5;break}for(;t<e.byteLength;)switch(e[t]){case 0:if(0!==e[t-1]){t+=2;break}else if(0!==e[t-2]){t++;break}if(i+3!==t-2)this.trigger("data",e.subarray(i+3,t-2));do t++;while(1!==e[t]&&t<e.length);i=t-2,t+=3;break;case 1:if(0!==e[t-1]||0!==e[t-2]){t+=3;break}this.trigger("data",e.subarray(i+3,t-2)),i=t-2,t+=3;break;default:t+=3}e=e.subarray(i),t-=i,i=0},this.flush=function(){if(e&&e.byteLength>3)this.trigger("data",e.subarray(i+3));e=null,i=0,this.trigger("done")}},r.prototype=new o,n=function(){var t,e,i,o,a,l,c,u=new r;n.prototype.init.call(this),t=this,this.push=function(t){if("video"===t.type)e=t.trackId,i=t.pts,o=t.dts,u.push(t)},u.on("data",function(n){var r={trackId:e,pts:i,dts:o,data:n};switch(31&n[0]){case 5:r.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:r.nalUnitType="sei_rbsp",r.escapedRBSP=a(n.subarray(1));break;case 7:r.nalUnitType="seq_parameter_set_rbsp",r.escapedRBSP=a(n.subarray(1)),r.config=l(r.escapedRBSP);break;case 8:r.nalUnitType="pic_parameter_set_rbsp";break;case 9:r.nalUnitType="access_unit_delimiter_rbsp"}t.trigger("data",r)}),u.on("done",function(){t.trigger("done")}),this.flush=function(){u.flush()},c=function(t,e){var i,n,r=8,o=8;for(i=0;i<t;i++){if(0!==o)n=e.readExpGolomb(),o=(r+n+256)%256;r=0===o?r:o}},a=function(t){for(var e,i,n=t.byteLength,r=[],o=1;o<n-2;)if(0===t[o]&&0===t[o+1]&&3===t[o+2])r.push(o+2),o+=2;else o++;if(0===r.length)return t;e=n-r.length,i=new Uint8Array(e);var s=0;for(o=0;o<e;s++,o++){if(s===r[0])s++,r.shift();i[o]=t[s]}return i},l=function(t){var e,i,n,r,o,a,l,u,d,h,p,f,m,g,y=0,v=0,b=0,_=0,w=1;if(e=new s(t),i=e.readUnsignedByte(),r=e.readUnsignedByte(),n=e.readUnsignedByte(),e.skipUnsignedExpGolomb(),100===i||110===i||122===i||244===i||44===i||83===i||86===i||118===i||128===i||138===i||139===i||134===i){if(o=e.readUnsignedExpGolomb(),3===o)e.skipBits(1);if(e.skipUnsignedExpGolomb(),e.skipUnsignedExpGolomb(),e.skipBits(1),e.readBoolean())for(p=3!==o?8:12,g=0;g<p;g++)if(e.readBoolean())if(g<6)c(16,e);else c(64,e)}if(e.skipUnsignedExpGolomb(),a=e.readUnsignedExpGolomb(),0===a)e.readUnsignedExpGolomb();else if(1===a)for(e.skipBits(1),e.skipExpGolomb(),e.skipExpGolomb(),l=e.readUnsignedExpGolomb(),g=0;g<l;g++)e.skipExpGolomb();if(e.skipUnsignedExpGolomb(),e.skipBits(1),u=e.readUnsignedExpGolomb(),d=e.readUnsignedExpGolomb(),h=e.readBits(1),0===h)e.skipBits(1);if(e.skipBits(1),e.readBoolean())y=e.readUnsignedExpGolomb(),v=e.readUnsignedExpGolomb(),b=e.readUnsignedExpGolomb(),_=e.readUnsignedExpGolomb();if(e.readBoolean())if(e.readBoolean()){switch(m=e.readUnsignedByte()){case 1:f=[1,1];break;case 2:f=[12,11];break;case 3:f=[10,11];break;case 4:f=[16,11];break;case 5:f=[40,33];break;case 6:f=[24,11];break;case 7:f=[20,11];break;case 8:f=[32,11];break;case 9:f=[80,33];break;case 10:f=[18,11];break;case 11:f=[15,11];break;case 12:f=[64,33];break;case 13:f=[160,99];break;case 14:f=[4,3];break;case 15:f=[3,2];break;case 16:f=[2,1];break;case 255:f=[e.readUnsignedByte()<<8|e.readUnsignedByte(),e.readUnsignedByte()<<8|e.readUnsignedByte()]}if(f)w=f[0]/f[1]}return{profileIdc:i,levelIdc:n,profileCompatibility:r,width:Math.ceil((16*(u+1)-2*y-2*v)*w),height:(2-h)*(d+1)*16-2*b-2*_}}},n.prototype=new o,e.exports={H264Stream:n,NalByteStream:r}},{"../utils/exp-golomb.js":80,"../utils/stream.js":81}],70:[function(t,e,i){"use strict";var n;n=function(t,e){var i,r=0,o=16384,s=function(t,e){var i,n=t.position+e;if(!(n<t.bytes.byteLength))i=new Uint8Array(2*n),i.set(t.bytes.subarray(0,t.position),0),t.bytes=i,t.view=new DataView(t.bytes.buffer)},a=n.widthBytes||new Uint8Array("width".length),l=n.heightBytes||new Uint8Array("height".length),c=n.videocodecidBytes||new Uint8Array("videocodecid".length);if(!n.widthBytes){for(i=0;i<"width".length;i++)a[i]="width".charCodeAt(i);for(i=0;i<"height".length;i++)l[i]="height".charCodeAt(i);for(i=0;i<"videocodecid".length;i++)c[i]="videocodecid".charCodeAt(i);n.widthBytes=a,n.heightBytes=l,n.videocodecidBytes=c}switch(this.keyFrame=!1,t){case n.VIDEO_TAG:this.length=16,o*=6;break;case n.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case n.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw"Error Unknown TagType"}this.bytes=new Uint8Array(o),this.view=new DataView(this.bytes.buffer),this.bytes[0]=t,this.position=this.length,this.keyFrame=e,this.pts=0,this.dts=0,this.writeBytes=function(t,e,i){var n,r=e||0;i=i||t.byteLength,n=r+i,s(this,i),this.bytes.set(t.subarray(r,n),this.position),this.position+=i,this.length=Math.max(this.length,this.position)},this.writeByte=function(t){s(this,1),this.bytes[this.position]=t,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(t){s(this,2),this.view.setUint16(this.position,t),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(t){return this.bytes[this.length-t]},this.nalUnitSize=function(){if(0===r)return 0;else return this.length-(r+4)},this.startNalUnit=function(){if(r>0)throw new Error("Attempted to create new NAL wihout closing the old one");r=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(t){var e,i;if(this.length===r+4)this.length-=4;else if(r>0)if(e=r+4,i=this.length-e,this.position=r,this.view.setUint32(this.position,i),this.position=this.length,t)t.push(this.bytes.subarray(e,e+i));r=0},this.writeMetaDataDouble=function(t,e){var i;if(s(this,2+t.length+9),this.view.setUint16(this.position,t.length),this.position+=2,"width"===t)this.bytes.set(a,this.position),this.position+=5;else if("height"===t)this.bytes.set(l,this.position),this.position+=6;else if("videocodecid"===t)this.bytes.set(c,this.position),this.position+=12;else for(i=0;i<t.length;i++)this.bytes[this.position]=t.charCodeAt(i),this.position++;this.position++,this.view.setFloat64(this.position,e),this.position+=8,this.length=Math.max(this.length,this.position),++r},this.writeMetaDataBoolean=function(t,e){var i;for(s(this,2),this.view.setUint16(this.position,t.length),this.position+=2,i=0;i<t.length;i++)s(this,1),this.bytes[this.position]=t.charCodeAt(i),this.position++;s(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,e?1:0),this.position++,this.length=Math.max(this.length,this.position),++r},this.finalize=function(){var t,i;switch(this.bytes[0]){case n.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||e?16:32),this.bytes[12]=e?0:1,t=this.pts-this.dts,this.bytes[13]=(16711680&t)>>>16,this.bytes[14]=(65280&t)>>>8,this.bytes[15]=(255&t)>>>0;break;case n.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=e?0:1;break;case n.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,r),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return i=this.length-11,this.bytes[1]=(16711680&i)>>>16,this.bytes[2]=(65280&i)>>>8,this.bytes[3]=(255&i)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,s(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=n.frameTime(this.bytes),this}},n.AUDIO_TAG=8,n.VIDEO_TAG=9,n.METADATA_TAG=18,n.isAudioFrame=function(t){return n.AUDIO_TAG===t[0]},n.isVideoFrame=function(t){return n.VIDEO_TAG===t[0]},n.isMetaData=function(t){return n.METADATA_TAG===t[0]},n.isKeyFrame=function(t){if(n.isVideoFrame(t))return 23===t[11];if(n.isAudioFrame(t))return!0;if(n.isMetaData(t))return!0;else return!1},n.frameTime=function(t){var e=t[4]<<16;return e|=t[5]<<8,e|=t[6]<<0,e|=t[7]<<24},e.exports=n},{}],71:[function(t,e,i){e.exports={tag:t("./flv-tag"),Transmuxer:t("./transmuxer")}},{"./flv-tag":70,"./transmuxer":72}],72:[function(t,e,i){"use strict";var n,r,o,s,a,l,c,u=t("../utils/stream.js"),d=t("./flv-tag.js"),h=t("../m2ts/m2ts.js"),p=t("../codecs/adts.js"),f=t("../codecs/h264").H264Stream;a=function(t,e){if("number"==typeof e.pts)if(void 0===t.timelineStartInfo.pts)t.timelineStartInfo.pts=e.pts;else t.timelineStartInfo.pts=Math.min(t.timelineStartInfo.pts,e.pts);if("number"==typeof e.dts)if(void 0===t.timelineStartInfo.dts)t.timelineStartInfo.dts=e.dts;else t.timelineStartInfo.dts=Math.min(t.timelineStartInfo.dts,e.dts)},l=function(t,e){var i=new d(d.METADATA_TAG);return i.dts=e,i.pts=e,i.writeMetaDataDouble("videocodecid",7),i.writeMetaDataDouble("width",t.width),i.writeMetaDataDouble("height",t.height),i},c=function(t,e){var i,n=new d(d.VIDEO_TAG,!0);for(n.dts=e,n.pts=e,n.writeByte(1),
n.writeByte(t.profileIdc),n.writeByte(t.profileCompatibility),n.writeByte(t.levelIdc),n.writeByte(255),n.writeByte(225),n.writeShort(t.sps[0].length),n.writeBytes(t.sps[0]),n.writeByte(t.pps.length),i=0;i<t.pps.length;++i)n.writeShort(t.pps[i].length),n.writeBytes(t.pps[i]);return n},o=function(t){var e,i=[];o.prototype.init.call(this),this.push=function(e){if(a(t,e),t&&void 0===t.channelcount)t.audioobjecttype=e.audioobjecttype,t.channelcount=e.channelcount,t.samplerate=e.samplerate,t.samplingfrequencyindex=e.samplingfrequencyindex,t.samplesize=e.samplesize,t.extraData=t.audioobjecttype<<11|t.samplingfrequencyindex<<7|t.channelcount<<3;e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),i.push(e)},this.flush=function(){var n,r,o,s=[];if(0===i.length)return void this.trigger("done");for(o=-(1/0);i.length;){if(n=i.shift(),t.extraData!==e||n.pts-o>=1e3)r=new d(d.METADATA_TAG),r.pts=n.pts,r.dts=n.dts,r.writeMetaDataDouble("audiocodecid",10),r.writeMetaDataBoolean("stereo",2===t.channelcount),r.writeMetaDataDouble("audiosamplerate",t.samplerate),r.writeMetaDataDouble("audiosamplesize",16),s.push(r),e=t.extraData,r=new d(d.AUDIO_TAG,!0),r.pts=n.pts,r.dts=n.dts,r.view.setUint16(r.position,t.extraData),r.position+=2,r.length=Math.max(r.length,r.position),s.push(r),o=n.pts;r=new d(d.AUDIO_TAG),r.pts=n.pts,r.dts=n.dts,r.writeBytes(n.data),s.push(r)}e=null,this.trigger("data",{track:t,tags:s}),this.trigger("done")}},o.prototype=new u,r=function(t){var e,i,n=[];r.prototype.init.call(this),this.finishFrame=function(i,n){if(n){if(e&&t&&t.newMetadata&&(n.keyFrame||0===i.length))i.push(l(e,n.pts)),i.push(c(t,n.pts)),t.newMetadata=!1;n.endNalUnit(),i.push(n)}},this.push=function(e){a(t,e),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),n.push(e)},this.flush=function(){for(var r,o=[];n.length&&"access_unit_delimiter_rbsp"!==n[0].nalUnitType;)n.shift();if(0===n.length)return void this.trigger("done");for(;n.length;){if(r=n.shift(),"seq_parameter_set_rbsp"===r.nalUnitType)t.newMetadata=!0,e=r.config,t.width=e.width,t.height=e.height,t.sps=[r.data],t.profileIdc=e.profileIdc,t.levelIdc=e.levelIdc,t.profileCompatibility=e.profileCompatibility,i.endNalUnit();else if("pic_parameter_set_rbsp"===r.nalUnitType)t.newMetadata=!0,t.pps=[r.data],i.endNalUnit();else if("access_unit_delimiter_rbsp"===r.nalUnitType){if(i)this.finishFrame(o,i);i=new d(d.VIDEO_TAG),i.pts=r.pts,i.dts=r.dts}else{if("slice_layer_without_partitioning_rbsp_idr"===r.nalUnitType)i.keyFrame=!0;i.endNalUnit()}i.startNalUnit(),i.writeBytes(r.data)}if(i)this.finishFrame(o,i);this.trigger("data",{track:t,tags:o}),this.trigger("done")}},r.prototype=new u,s=function(t){this.numberOfTracks=0,this.metadataStream=t.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,s.prototype.init.call(this),this.push=function(t){if(t.text)return this.pendingCaptions.push(t);if(t.frames)return this.pendingMetadata.push(t);if("video"===t.track.type)this.videoTrack=t.track,this.videoTags=t.tags,this.pendingTracks++;if("audio"===t.track.type)this.audioTrack=t.track,this.audioTags=t.tags,this.pendingTracks++}},s.prototype=new u,s.prototype.flush=function(){var t,e,i,n,r={tags:{},captions:[],metadata:[]};if(!(this.pendingTracks<this.numberOfTracks)){if(this.videoTrack)n=this.videoTrack.timelineStartInfo.pts;else if(this.audioTrack)n=this.audioTrack.timelineStartInfo.pts;for(r.tags.videoTags=this.videoTags,r.tags.audioTags=this.audioTags,i=0;i<this.pendingCaptions.length;i++)e=this.pendingCaptions[i],e.startTime=e.startPts-n,e.startTime/=9e4,e.endTime=e.endPts-n,e.endTime/=9e4,r.captions.push(e);for(i=0;i<this.pendingMetadata.length;i++)t=this.pendingMetadata[i],t.cueTime=t.pts-n,t.cueTime/=9e4,r.metadata.push(t);r.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.trigger("data",r),this.trigger("done")}},n=function(t){var e,i,a,l,c,u,m,g,y,v=this;n.prototype.init.call(this),t=t||{},this.metadataStream=new h.MetadataStream,t.metadataStream=this.metadataStream,e=new h.TransportPacketStream,i=new h.TransportParseStream,a=new h.ElementaryStream,l=new p,c=new f,y=new s(t),e.pipe(i).pipe(a),a.pipe(c),a.pipe(l),a.pipe(this.metadataStream).pipe(y),g=new h.CaptionStream,c.pipe(g).pipe(y),a.on("data",function(t){var e,i,n;if("metadata"===t.type){for(e=t.tracks.length;e--;)if("video"===t.tracks[e].type)i=t.tracks[e];else if("audio"===t.tracks[e].type)n=t.tracks[e];if(i&&!u)y.numberOfTracks++,u=new r(i),c.pipe(u).pipe(y);if(n&&!m)y.numberOfTracks++,m=new o(n),l.pipe(m).pipe(y)}}),this.push=function(t){e.push(t)},this.flush=function(){e.flush()},y.on("data",function(t){v.trigger("data",t)}),y.on("done",function(){v.trigger("done")}),this.getFlvHeader=function(t,e,i){var n,r,o,s=new Uint8Array(9),a=new DataView(s.buffer);if(t=t||0,e=void 0===e?!0:e,i=void 0===i?!0:i,a.setUint8(0,70),a.setUint8(1,76),a.setUint8(2,86),a.setUint8(3,1),a.setUint8(4,(e?4:0)|(i?1:0)),a.setUint32(5,s.byteLength),t<=0)return r=new Uint8Array(s.byteLength+4),r.set(s),r.set([0,0,0,0],s.byteLength),r;else return n=new d(d.METADATA_TAG),n.pts=n.dts=0,n.writeMetaDataDouble("duration",t),o=n.finalize().length,r=new Uint8Array(s.byteLength+o),r.set(s),r.set(a.byteLength,o),r}},n.prototype=new u,e.exports=n},{"../codecs/adts.js":68,"../codecs/h264":69,"../m2ts/m2ts.js":74,"../utils/stream.js":81,"./flv-tag.js":70}],73:[function(t,e,i){"use strict";var n=4,r=128,o=t("../utils/stream"),s=function(t){for(var e=0,i={payloadType:-1,payloadSize:0},o=0,s=0;e<t.byteLength&&t[e]!==r;){for(;255===t[e];)o+=255,e++;for(o+=t[e++];255===t[e];)s+=255,e++;if(s+=t[e++],!i.payload&&o===n){i.payloadType=o,i.payloadSize=s,i.payload=t.subarray(e,e+s);break}e+=s,o=0,s=0}return i},a=function(t){if(181!==t.payload[0])return null;if(49!==(t.payload[1]<<8|t.payload[2]))return null;if("GA94"!==String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6]))return null;if(3!==t.payload[7])return null;else return t.payload.subarray(8,t.payload.length-1)},l=function(t,e){var i,n,r,o,s=[];if(!(64&e[0]))return s;for(n=31&e[0],i=0;i<n;i++)if(r=3*i,o={type:3&e[r+2],pts:t},4&e[r+2])o.ccData=e[r+3]<<8|e[r+4],s.push(o);return s},c=function(){c.prototype.init.call(this),this.captionPackets_=[],this.field1_=new k,this.field1_.on("data",this.trigger.bind(this,"data")),this.field1_.on("done",this.trigger.bind(this,"done"))};c.prototype=new o,c.prototype.push=function(t){var e,i;if("sei_rbsp"===t.nalUnitType)if(e=s(t.escapedRBSP),e.payloadType===n)if(i=a(e))this.captionPackets_=this.captionPackets_.concat(l(t.pts,i))},c.prototype.flush=function(){if(!this.captionPackets_.length)return void this.field1_.flush();else return this.captionPackets_.sort(function(t,e){return t.pts-e.pts}),this.captionPackets_.forEach(this.field1_.push,this.field1_),this.captionPackets_.length=0,void this.field1_.flush()};var u={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608},d=function(t){if(null===t)return"";else return t=u[t]||t,String.fromCharCode(t)},h=0,p=5152,f=5167,m=5157,g=5158,y=5159,v=5165,b=5153,_=5164,w=5166,x=14,T=function(){for(var t=[],e=x+1;e--;)t.push("");return t},k=function(){k.prototype.init.call(this),this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=T(),this.nonDisplayed_=T(),this.lastControlCode_=null,this.push=function(t){if(0===t.type){var e,i,n,r;if(e=32639&t.ccData,e===this.lastControlCode_)return void(this.lastControlCode_=null);if(4096===(61440&e))this.lastControlCode_=e;else this.lastControlCode_=null;switch(e){case h:break;case p:this.mode_="popOn";break;case f:this.flushDisplayed(t.pts),i=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=i,this.startPts_=t.pts;break;case m:this.topRow_=x-1,this.mode_="rollUp";break;case g:this.topRow_=x-2,this.mode_="rollUp";break;case y:this.topRow_=x-3,this.mode_="rollUp";break;case v:this.flushDisplayed(t.pts),this.shiftRowsUp_(),this.startPts_=t.pts;break;case b:if("popOn"===this.mode_)this.nonDisplayed_[x]=this.nonDisplayed_[x].slice(0,-1);else this.displayed_[x]=this.displayed_[x].slice(0,-1);break;case _:this.flushDisplayed(t.pts),this.displayed_=T();break;case w:this.nonDisplayed_=T();break;default:if(n=e>>>8,r=255&e,n>=16&&n<=23&&r>=64&&r<=127&&(16!==n||r<96))n=32,r=null;if((17===n||25===n)&&r>=48&&r<=63)n=9834,r="";if(16===(240&n))return;this[this.mode_](t.pts,n,r)}}}};k.prototype=new o,k.prototype.flushDisplayed=function(t){var e=this.displayed_.map(function(t){return t.trim()}).filter(function(t){return t.length}).join("\n");if(e.length)this.trigger("data",{startPts:this.startPts_,endPts:t,text:e})},k.prototype.popOn=function(t,e,i){var n=this.nonDisplayed_[x];n+=d(e),n+=d(i),this.nonDisplayed_[x]=n},k.prototype.rollUp=function(t,e,i){var n=this.displayed_[x];if(""===n)this.flushDisplayed(t),this.startPts_=t;n+=d(e),n+=d(i),this.displayed_[x]=n},k.prototype.shiftRowsUp_=function(){var t;for(t=0;t<this.topRow_;t++)this.displayed_[t]="";for(t=this.topRow_;t<x;t++)this.displayed_[t]=this.displayed_[t+1];this.displayed_[x]=""},e.exports={CaptionStream:c,Cea608Stream:k}},{"../utils/stream":81}],74:[function(t,e,i){"use strict";var n,r,o,s=t("../utils/stream.js"),a=t("./caption-stream"),l=t("./stream-types"),s=t("../utils/stream.js"),c=t("./stream-types.js"),u=188,d=71,n=function(){var t=new Uint8Array(u),e=0;n.prototype.init.call(this),this.push=function(i){var n,r=0,o=u;if(e)n=new Uint8Array(i.byteLength+e),n.set(t.subarray(0,e)),n.set(i,e),e=0;else n=i;for(;o<n.byteLength;)if(n[r]!==d||n[o]!==d)r++,o++;else this.trigger("data",n.subarray(r,o)),r+=u,o+=u;if(r<n.byteLength)t.set(n.subarray(r),0),e=n.byteLength-r},this.flush=function(){if(e===u&&t[0]===d)this.trigger("data",t),e=0;this.trigger("done")}};n.prototype=new s,r=function(){var t,e,i,n;r.prototype.init.call(this),n=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,t=function(t,n){var r=0;if(n.payloadUnitStartIndicator)r+=t[r]+1;if("pat"===n.type)e(t.subarray(r),n);else i(t.subarray(r),n)},e=function(t,e){e.section_number=t[7],e.last_section_number=t[8],n.pmtPid=(31&t[10])<<8|t[11],e.pmtPid=n.pmtPid},i=function(t,e){var i,r,o,s;if(1&t[5]){for(n.programMapTable={},i=(15&t[1])<<8|t[2],r=3+i-4,o=(15&t[10])<<8|t[11],s=12+o;s<r;)n.programMapTable[(31&t[s+1])<<8|t[s+2]]=t[s],s+=((15&t[s+3])<<8|t[s+4])+5;for(e.programMapTable=n.programMapTable;n.packetsWaitingForPmt.length;)n.processPes_.apply(n,n.packetsWaitingForPmt.shift())}},this.push=function(e){var i={},n=4;if(i.payloadUnitStartIndicator=!!(64&e[1]),i.pid=31&e[1],i.pid<<=8,i.pid|=e[2],(48&e[3])>>>4>1)n+=e[n]+1;if(0===i.pid)i.type="pat",t(e.subarray(n),i),this.trigger("data",i);else if(i.pid===this.pmtPid)i.type="pmt",t(e.subarray(n),i),this.trigger("data",i);else if(void 0===this.programMapTable)this.packetsWaitingForPmt.push([e,n,i]);else this.processPes_(e,n,i)},this.processPes_=function(t,e,i){i.streamType=this.programMapTable[i.pid],i.type="pes",i.data=t.subarray(e),this.trigger("data",i)}},r.prototype=new s,r.STREAM_TYPES={h264:27,adts:15},o=function(){var t,e={data:[],size:0},i={data:[],size:0},n={data:[],size:0},r=function(t,e){var i;if(e.dataAlignmentIndicator=0!==(4&t[6]),i=t[7],192&i)if(e.pts=(14&t[9])<<27|(255&t[10])<<20|(254&t[11])<<12|(255&t[12])<<5|(254&t[13])>>>3,e.pts*=4,e.pts+=(6&t[13])>>>1,e.dts=e.pts,64&i)e.dts=(14&t[14])<<27|(255&t[15])<<20|(254&t[16])<<12|(255&t[17])<<5|(254&t[18])>>>3,e.dts*=4,e.dts+=(6&t[18])>>>1;e.data=t.subarray(9+t[8])},s=function(e,i){var n,o=new Uint8Array(e.size),s={type:i},a=0;if(e.data.length){for(s.trackId=e.data[0].pid;e.data.length;)n=e.data.shift(),o.set(n.data,a),a+=n.data.byteLength;r(o,s),e.size=0,t.trigger("data",s)}};o.prototype.init.call(this),t=this,this.push=function(r){({pat:function(){},pes:function(){var t,o;switch(r.streamType){case l.H264_STREAM_TYPE:case c.H264_STREAM_TYPE:t=e,o="video";break;case l.ADTS_STREAM_TYPE:t=i,o="audio";break;case l.METADATA_STREAM_TYPE:t=n,o="timed-metadata";break;default:return}if(r.payloadUnitStartIndicator)s(t,o);t.data.push(r),t.size+=r.data.byteLength},pmt:function(){var e,i,n={type:"metadata",tracks:[]},o=r.programMapTable;for(e in o)if(o.hasOwnProperty(e)){if(i={timelineStartInfo:{baseMediaDecodeTime:0}},i.id=+e,o[e]===c.H264_STREAM_TYPE)i.codec="avc",i.type="video";else if(o[e]===c.ADTS_STREAM_TYPE)i.codec="adts",i.type="audio";n.tracks.push(i)}t.trigger("data",n)}})[r.type]()},this.flush=function(){s(e,"video"),s(i,"audio"),s(n,"timed-metadata"),this.trigger("done")}},o.prototype=new s;var h={PAT_PID:0,MP2T_PACKET_LENGTH:u,TransportPacketStream:n,TransportParseStream:r,ElementaryStream:o,CaptionStream:a.CaptionStream,Cea608Stream:a.Cea608Stream,MetadataStream:t("./metadata-stream")};for(var p in l)if(l.hasOwnProperty(p))h[p]=l[p];e.exports=h},{"../utils/stream.js":81,"./caption-stream":73,"./metadata-stream":75,"./stream-types":76,"./stream-types.js":76}],75:[function(t,e,i){"use strict";var n,r=t("../utils/stream"),o=t("./stream-types"),s=function(t,e,i){var n,r="";for(n=e;n<i;n++)r+="%"+("00"+t[n].toString(16)).slice(-2);return r},a=function(t,e,i){return decodeURIComponent(s(t,e,i))},l=function(t,e,i){return unescape(s(t,e,i))},c=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},u={TXXX:function(t){var e;if(3===t.data[0]){for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=a(t.data,1,e),t.value=a(t.data,e+1,t.data.length-1);break}t.data=t.value}},WXXX:function(t){var e;if(3===t.data[0])for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=a(t.data,1,e),t.url=a(t.data,e+1,t.data.length);break}},PRIV:function(t){var e;for(e=0;e<t.data.length;e++)if(0===t.data[e]){t.owner=l(t.data,0,e);break}t.privateData=t.data.subarray(e+1),t.data=t.privateData}};n=function(t){var e,i={debug:!(!t||!t.debug),descriptor:t&&t.descriptor},r=0,s=[],a=0;if(n.prototype.init.call(this),this.dispatchType=o.METADATA_STREAM_TYPE.toString(16),i.descriptor)for(e=0;e<i.descriptor.length;e++)this.dispatchType+=("00"+i.descriptor[e].toString(16)).slice(-2);this.push=function(t){var e,n,o,l,d,h;if("timed-metadata"===t.type){if(t.dataAlignmentIndicator)a=0,s.length=0;if(0!==s.length||!(t.data.length<10||t.data[0]!=="I".charCodeAt(0)||t.data[1]!=="D".charCodeAt(0)||t.data[2]!=="3".charCodeAt(0))){if(s.push(t),a+=t.data.byteLength,1===s.length)r=c(t.data.subarray(6,10)),r+=10;if(!(a<r)){for(e={data:new Uint8Array(r),frames:[],pts:s[0].pts,dts:s[0].dts},d=0;d<r;)e.data.set(s[0].data.subarray(0,r-d),d),d+=s[0].data.byteLength,a-=s[0].data.byteLength,s.shift();if(n=10,64&e.data[5])n+=4,n+=c(e.data.subarray(10,14)),r-=c(e.data.subarray(16,20));do{if(o=c(e.data.subarray(n+4,n+8)),o<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if(h=String.fromCharCode(e.data[n],e.data[n+1],e.data[n+2],e.data[n+3]),l={id:h,data:e.data.subarray(n+10,n+o+10)},l.key=l.id,u[l.id])if(u[l.id](l),"com.apple.streaming.transportStreamTimestamp"===l.owner){var p=l.data,f=(1&p[3])<<30|p[4]<<22|p[5]<<14|p[6]<<6|p[7]>>>2;f*=4,f+=3&p[7],l.timeStamp=f,this.trigger("timestamp",l)}e.frames.push(l),n+=10,n+=o}while(n<r);this.trigger("data",e)}}else if(i.debug)console.log("Skipping unrecognized metadata packet")}}},n.prototype=new r,e.exports=n},{"../utils/stream":81,"./stream-types":76}],76:[function(t,e,i){"use strict";e.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},{}],77:[function(t,e,i){e.exports={generator:t("./mp4-generator"),Transmuxer:t("./transmuxer").Transmuxer,AudioSegmentStream:t("./transmuxer").AudioSegmentStream,VideoSegmentStream:t("./transmuxer").VideoSegmentStream}},{"./mp4-generator":78,"./transmuxer":79}],78:[function(t,e,i){"use strict";var n,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v,b,_,w,x,T,k,S,j,E,P,C,O,M,I,A,D,N,L,B,U,R;!function(){var t;if(j={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(t in j)if(j.hasOwnProperty(t))j[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)];E=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),C=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),P=new Uint8Array([0,0,0,1]),O=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),M=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),I={video:O,audio:M},N=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),D=new Uint8Array([0,0,0,0,0,0,0,0]),L=new Uint8Array([0,0,0,0,0,0,0,0]),B=L,U=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),R=L,A=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),n=function(t){var e,i,n,r=[],o=0;for(e=1;e<arguments.length;e++)r.push(arguments[e]);for(e=r.length;e--;)o+=r[e].byteLength;for(i=new Uint8Array(o+8),n=new DataView(i.buffer,i.byteOffset,i.byteLength),n.setUint32(0,i.byteLength),i.set(t,4),e=0,o=8;e<r.length;e++)i.set(r[e],o),o+=r[e].byteLength;return i},r=function(){return n(j.dinf,n(j.dref,N))},o=function(t){return n(j.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},s=function(){return n(j.ftyp,E,P,E,C)},v=function(t){return n(j.hdlr,I[t])},a=function(t){return n(j.mdat,t)},y=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);if(t.samplerate)e[12]=t.samplerate>>>24&255,e[13]=t.samplerate>>>16&255,e[14]=t.samplerate>>>8&255,e[15]=255&t.samplerate;return n(j.mdhd,e)},g=function(t){return n(j.mdia,y(t),v(t.type),c(t))},l=function(t){return n(j.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},c=function(t){return n(j.minf,"video"===t.type?n(j.vmhd,A):n(j.smhd,D),r(),_(t))},u=function(t,e){for(var i=[],r=e.length;r--;)i[r]=T(e[r]);return n.apply(null,[j.moof,l(t)].concat(i))},d=function(t){for(var e=t.length,i=[];e--;)i[e]=f(t[e]);return n.apply(null,[j.moov,p(4294967295)].concat(i).concat(h(t)))},h=function(t){for(var e=t.length,i=[];e--;)i[e]=k(t[e]);return n.apply(null,[j.mvex].concat(i))},p=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n(j.mvhd,e)},b=function(t){var e,i,r=t.samples||[],o=new Uint8Array(4+r.length);for(i=0;i<r.length;i++)e=r[i].flags,o[i+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return n(j.sdtp,o)},_=function(t){return n(j.stbl,w(t),n(j.stts,R),n(j.stsc,B),n(j.stsz,U),n(j.stco,L))},function(){var t,e;w=function(i){return n(j.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===i.type?t(i):e(i))},t=function(t){var e,i=t.sps||[],r=t.pps||[],o=[],s=[];for(e=0;e<i.length;e++)o.push((65280&i[e].byteLength)>>>8),o.push(255&i[e].byteLength),o=o.concat(Array.prototype.slice.call(i[e]));for(e=0;e<r.length;e++)s.push((65280&r[e].byteLength)>>>8),s.push(255&r[e].byteLength),s=s.concat(Array.prototype.slice.call(r[e]));return n(j.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),n(j.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([i.length]).concat(o).concat([r.length]).concat(s))),n(j.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},e=function(t){return n(j.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),o(t))}}(),x=function(){return n(j.styp,E,P,E)},m=function(t){var e=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return n(j.tkhd,e)},T=function(t){var e,i,r,o,s;if(e=n(j.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),i=n(j.tfdt,new Uint8Array([0,0,0,0,t.baseMediaDecodeTime>>>24&255,t.baseMediaDecodeTime>>>16&255,t.baseMediaDecodeTime>>>8&255,255&t.baseMediaDecodeTime])),s=88,"audio"===t.type)return r=S(t,s),n(j.traf,e,i,r);else return o=b(t),r=S(t,o.length+s),n(j.traf,e,i,r,o)},f=function(t){return t.duration=t.duration||4294967295,n(j.trak,m(t),g(t))},k=function(t){var e=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if("video"!==t.type)e[e.length-1]=0;return n(j.trex,e)},function(){var t,e,i;i=function(t,e){var i=0,n=0,r=0,o=0;if(t.length){if(void 0!==t[0].duration)i=1;if(void 0!==t[0].size)n=2;if(void 0!==t[0].flags)r=4;if(void 0!==t[0].compositionTimeOffset)o=8}return[0,0,i|n|r|o,1,(4278190080&t.length)>>>24,(16711680&t.length)>>>16,(65280&t.length)>>>8,255&t.length,(4278190080&e)>>>24,(16711680&e)>>>16,(65280&e)>>>8,255&e]},e=function(t,e){var r,o,s,a;for(o=t.samples||[],e+=20+16*o.length,r=i(o,e),a=0;a<o.length;a++)s=o[a],r=r.concat([(4278190080&s.duration)>>>24,(16711680&s.duration)>>>16,(65280&s.duration)>>>8,255&s.duration,(4278190080&s.size)>>>24,(16711680&s.size)>>>16,(65280&s.size)>>>8,255&s.size,s.flags.isLeading<<2|s.flags.dependsOn,s.flags.isDependedOn<<6|s.flags.hasRedundancy<<4|s.flags.paddingValue<<1|s.flags.isNonSyncSample,61440&s.flags.degradationPriority,15&s.flags.degradationPriority,(4278190080&s.compositionTimeOffset)>>>24,(16711680&s.compositionTimeOffset)>>>16,(65280&s.compositionTimeOffset)>>>8,255&s.compositionTimeOffset]);return n(j.trun,new Uint8Array(r))},t=function(t,e){var r,o,s,a;for(o=t.samples||[],e+=20+8*o.length,r=i(o,e),a=0;a<o.length;a++)s=o[a],r=r.concat([(4278190080&s.duration)>>>24,(16711680&s.duration)>>>16,(65280&s.duration)>>>8,255&s.duration,(4278190080&s.size)>>>24,(16711680&s.size)>>>16,(65280&s.size)>>>8,255&s.size]);return n(j.trun,new Uint8Array(r))},S=function(i,n){if("audio"===i.type)return t(i,n);else return e(i,n)}}(),e.exports={ftyp:s,mdat:a,moof:u,moov:d,initSegment:function(t){var e,i=s(),n=d(t);return e=new Uint8Array(i.byteLength+n.byteLength),e.set(i),e.set(n,i.byteLength),e}}},{}],79:[function(t,e,i){"use strict";var n,r,o,s,a,l,c,u,d,h,p,f=t("../utils/stream.js"),m=t("./mp4-generator.js"),g=t("../m2ts/m2ts.js"),y=t("../codecs/adts.js"),v=t("../codecs/h264").H264Stream,b=t("../aac"),_=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],w=["width","height","profileIdc","levelIdc","profileCompatibility"];a=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0}}},l=function(t){if(t[0]==="I".charCodeAt(0)&&t[1]==="D".charCodeAt(0)&&t[2]==="3".charCodeAt(0))return!0;else return!1},h=function(t,e){var i;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},p=function(t){var e,i,n=0;for(e=0;e<t.length;e++)i=t[e],n+=i.data.byteLength;return n},r=function(t){var e=[],i=0,n=0;r.prototype.init.call(this),this.push=function(i){if(c(t,i),t)_.forEach(function(e){t[e]=i[e]});e.push(i)},this.setEarliestDts=function(e){n=e-t.timelineStartInfo.baseMediaDecodeTime},this.flush=function(){var n,r,o,s;if(0===e.length)return void this.trigger("done","AudioSegmentStream");else return n=this.trimAdtsFramesByEarliestDts_(e),t.samples=this.generateSampleTable_(n),o=m.mdat(this.concatenateFrameData_(n)),e=[],d(t),r=m.moof(i,[t]),s=new Uint8Array(r.byteLength+o.byteLength),i++,s.set(r),s.set(o,r.byteLength),u(t),this.trigger("data",{track:t,boxes:s}),void this.trigger("done","AudioSegmentStream")},this.trimAdtsFramesByEarliestDts_=function(e){if(t.minSegmentDts>=n)return e;else return t.minSegmentDts=1/0,e.filter(function(e){if(e.dts>=n)return t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0;else return!1})},this.generateSampleTable_=function(t){var e,i,n=[];for(e=0;e<t.length;e++)i=t[e],n.push({size:i.data.byteLength,duration:1024});return n},this.concatenateFrameData_=function(t){var e,i,n=0,r=new Uint8Array(p(t));for(e=0;e<t.length;e++)i=t[e],r.set(i.data,n),n+=i.data.byteLength;return r}},r.prototype=new f,n=function(t){var e,i,r=0,o=[];n.prototype.init.call(this),delete t.minPTS,this.gopCache_=[],this.push=function(n){if(c(t,n),"seq_parameter_set_rbsp"===n.nalUnitType&&!e)e=n.config,t.sps=[n.data],w.forEach(function(i){t[i]=e[i]},this);if("pic_parameter_set_rbsp"===n.nalUnitType&&!i)i=n.data,t.pps=[n.data];o.push(n)},this.flush=function(){for(var e,i,n,s,a,l;o.length&&"access_unit_delimiter_rbsp"!==o[0].nalUnitType;)o.shift();if(0===o.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(e=this.groupNalsIntoFrames_(o),n=this.groupFramesIntoGops_(e),!n[0][0].keyFrame)if(i=this.getGopForFusion_(o[0],t))n.unshift(i),n.byteLength+=i.byteLength,n.nalCount+=i.nalCount,n.pts=i.pts,n.dts=i.dts,n.duration+=i.duration;else n=this.extendFirstKeyFrame_(n);c(t,n),t.samples=this.generateSampleTable_(n),a=m.mdat(this.concatenateNalData_(n)),this.gopCache_.unshift({gop:n.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],d(t),this.trigger("timelineStartInfo",t.timelineStartInfo),s=m.moof(r,[t]),l=new Uint8Array(s.byteLength+a.byteLength),r++,l.set(s),l.set(a,s.byteLength),this.trigger("data",{track:t,boxes:l}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){u(t),e=void 0,i=void 0},this.getGopForFusion_=function(e){var i,n,r,o,s,a=45e3,l=1e4,c=1/0;for(s=0;s<this.gopCache_.length;s++)if(o=this.gopCache_[s],r=o.gop,t.pps&&h(t.pps[0],o.pps[0])&&t.sps&&h(t.sps[0],o.sps[0]))if(!(r.dts<t.timelineStartInfo.dts)){if(i=e.dts-r.dts-r.duration,i>=-l&&i<=a)if(!n||c>i)n=o,c=i}else;else;if(n)return n.gop;else return null},this.extendFirstKeyFrame_=function(t){var e;if(!t[0][0].keyFrame)e=t.shift(),t.byteLength-=e.byteLength,t.nalCount-=e.nalCount,t[0][0].dts=e.dts,t[0][0].pts=e.pts,t[0][0].duration+=e.duration;return t},this.groupNalsIntoFrames_=function(t){var e,i,n=[],r=[];for(n.byteLength=0,e=0;e<t.length;e++)if(i=t[e],"access_unit_delimiter_rbsp"===i.nalUnitType){if(n.length)n.duration=i.dts-n.dts,r.push(n);n=[i],n.byteLength=i.data.byteLength,n.pts=i.pts,n.dts=i.dts}else{if("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType)n.keyFrame=!0;n.duration=i.dts-n.dts,n.byteLength+=i.data.byteLength,n.push(i)}if(r.length&&(!n.duration||n.duration<=0))n.duration=r[r.length-1].duration;return r.push(n),r},this.groupFramesIntoGops_=function(t){var e,i,n=[],r=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=t[0].pts,n.dts=t[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=t[0].pts,r.dts=t[0].dts,e=0;e<t.length;e++)if(i=t[e],i.keyFrame){if(n.length)r.push(n),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration;n=[i],n.nalCount=i.length,n.byteLength=i.byteLength,n.pts=i.pts,n.dts=i.dts,n.duration=i.duration}else n.duration+=i.duration,n.nalCount+=i.length,n.byteLength+=i.byteLength,n.push(i);if(r.length&&n.duration<=0)n.duration=r[r.length-1].duration;return r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration,r.push(n),r},this.generateSampleTable_=function(t,e){var i,n,r,o,s,l=e||0,c=[];for(i=0;i<t.length;i++)for(o=t[i],n=0;n<o.length;n++){if(s=o[n],r=a(),r.dataOffset=l,r.compositionTimeOffset=s.pts-s.dts,r.duration=s.duration,r.size=4*s.length,r.size+=s.byteLength,s.keyFrame)r.flags.dependsOn=2;l+=r.size,c.push(r)}return c},this.concatenateNalData_=function(t){var e,i,n,r,o,s,a=0,l=t.byteLength,c=t.nalCount,u=l+4*c,d=new Uint8Array(u),h=new DataView(d.buffer);for(e=0;e<t.length;e++)for(r=t[e],i=0;i<r.length;i++)for(o=r[i],n=0;n<o.length;n++)s=o[n],h.setUint32(a,s.data.byteLength),a+=4,d.set(s.data,a),a+=s.data.byteLength;return d}},n.prototype=new f,c=function(t,e){if("number"==typeof e.pts){if(void 0===t.timelineStartInfo.pts)t.timelineStartInfo.pts=e.pts;if(void 0===t.minSegmentPts)t.minSegmentPts=e.pts;else t.minSegmentPts=Math.min(t.minSegmentPts,e.pts);if(void 0===t.maxSegmentPts)t.maxSegmentPts=e.pts;else t.maxSegmentPts=Math.max(t.maxSegmentPts,e.pts)}if("number"==typeof e.dts){if(void 0===t.timelineStartInfo.dts)t.timelineStartInfo.dts=e.dts;if(void 0===t.minSegmentDts)t.minSegmentDts=e.dts;else t.minSegmentDts=Math.min(t.minSegmentDts,e.dts);if(void 0===t.maxSegmentDts)t.maxSegmentDts=e.dts;else t.maxSegmentDts=Math.max(t.maxSegmentDts,e.dts)}},u=function(t){delete t.minSegmentDts,delete t.maxSegmentDts,delete t.minSegmentPts,delete t.maxSegmentPts},d=function(t){var e,i=9e4,n=t.minSegmentDts-t.timelineStartInfo.dts,r=t.minSegmentPts-t.minSegmentDts;if(t.baseMediaDecodeTime=t.timelineStartInfo.baseMediaDecodeTime,t.baseMediaDecodeTime+=n,t.baseMediaDecodeTime-=r,t.baseMediaDecodeTime=Math.max(0,t.baseMediaDecodeTime),"audio"===t.type)e=t.samplerate/i,t.baseMediaDecodeTime*=e,t.baseMediaDecodeTime=Math.floor(t.baseMediaDecodeTime)},s=function(t,e){if(this.numberOfTracks=0,this.metadataStream=e,"undefined"!=typeof t.remux)this.remuxTracks=!!t.remux;else this.remuxTracks=!0;this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,s.prototype.init.call(this),this.push=function(t){if(t.text)return this.pendingCaptions.push(t);if(t.frames)return this.pendingMetadata.push(t);if(this.pendingTracks.push(t.track),this.pendingBoxes.push(t.boxes),this.pendingBytes+=t.boxes.byteLength,"video"===t.track.type)this.videoTrack=t.track;if("audio"===t.track.type)this.audioTrack=t.track}},s.prototype=new f,s.prototype.flush=function(t){var e,i,n,r,o=0,s={captions:[],metadata:[],info:{}},a=0;if(this.pendingTracks.length<this.numberOfTracks)if("VideoSegmentStream"!==t&&"AudioSegmentStream"!==t)return;else if(this.remuxTracks)return;else if(0===this.pendingTracks.length){if(this.emittedTracks++,this.emittedTracks>=this.numberOfTracks)this.trigger("done"),this.emittedTracks=0;return}if(this.videoTrack)a=this.videoTrack.timelineStartInfo.pts,w.forEach(function(t){s.info[t]=this.videoTrack[t]},this);else if(this.audioTrack)a=this.audioTrack.timelineStartInfo.pts,_.forEach(function(t){s.info[t]=this.audioTrack[t]},this);if(1===this.pendingTracks.length)s.type=this.pendingTracks[0].type;else s.type="combined";for(this.emittedTracks+=this.pendingTracks.length,n=m.initSegment(this.pendingTracks),s.data=new Uint8Array(n.byteLength+this.pendingBytes),s.data.set(n),o+=n.byteLength,r=0;r<this.pendingBoxes.length;r++)s.data.set(this.pendingBoxes[r],o),o+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)e=this.pendingCaptions[r],e.startTime=e.startPts-a,e.startTime/=9e4,e.endTime=e.endPts-a,e.endTime/=9e4,s.captions.push(e);for(r=0;r<this.pendingMetadata.length;r++)i=this.pendingMetadata[r],i.cueTime=i.pts-a,i.cueTime/=9e4,s.metadata.push(i);if(s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,
this.trigger("data",s),this.emittedTracks>=this.numberOfTracks)this.trigger("done"),this.emittedTracks=0},o=function(t){var e,i,a=this,c=!0;o.prototype.init.call(this),t=t||{},this.baseMediaDecodeTime=t.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var e={};this.transmuxPipeline_=e,e.type="aac",e.metadataStream=new g.MetadataStream,e.aacStream=new b,e.adtsStream=new y,e.coalesceStream=new s(t,e.metadataStream),e.headOfPipeline=e.aacStream,e.aacStream.pipe(e.adtsStream),e.aacStream.pipe(e.metadataStream),e.metadataStream.pipe(e.coalesceStream),e.metadataStream.on("timestamp",function(t){e.aacStream.setTimestamp(t.timeStamp)}),e.aacStream.on("data",function(t){if("timed-metadata"===t.type&&!e.audioSegmentStream)i=i||{timelineStartInfo:{baseMediaDecodeTime:a.baseMediaDecodeTime},codec:"adts",type:"audio"},e.coalesceStream.numberOfTracks++,e.audioSegmentStream=new r(i),e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream)}),e.coalesceStream.on("data",this.trigger.bind(this,"data")),e.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var o={};this.transmuxPipeline_=o,o.type="ts",o.metadataStream=new g.MetadataStream,o.packetStream=new g.TransportPacketStream,o.parseStream=new g.TransportParseStream,o.elementaryStream=new g.ElementaryStream,o.adtsStream=new y,o.h264Stream=new v,o.captionStream=new g.CaptionStream,o.coalesceStream=new s(t,o.metadataStream),o.headOfPipeline=o.packetStream,o.packetStream.pipe(o.parseStream).pipe(o.elementaryStream),o.elementaryStream.pipe(o.h264Stream),o.elementaryStream.pipe(o.adtsStream),o.elementaryStream.pipe(o.metadataStream).pipe(o.coalesceStream),o.h264Stream.pipe(o.captionStream).pipe(o.coalesceStream),o.elementaryStream.on("data",function(t){var s;if("metadata"===t.type){for(s=t.tracks.length;s--;)if(!e&&"video"===t.tracks[s].type)e=t.tracks[s],e.timelineStartInfo.baseMediaDecodeTime=a.baseMediaDecodeTime;else if(!i&&"audio"===t.tracks[s].type)i=t.tracks[s],i.timelineStartInfo.baseMediaDecodeTime=a.baseMediaDecodeTime;if(e&&!o.videoSegmentStream)o.coalesceStream.numberOfTracks++,o.videoSegmentStream=new n(e),o.videoSegmentStream.on("timelineStartInfo",function(t){if(i)i.timelineStartInfo=t,o.audioSegmentStream.setEarliestDts(t.dts)}),o.h264Stream.pipe(o.videoSegmentStream).pipe(o.coalesceStream);if(i&&!o.audioSegmentStream)o.coalesceStream.numberOfTracks++,o.audioSegmentStream=new r(i),o.adtsStream.pipe(o.audioSegmentStream).pipe(o.coalesceStream)}}),o.coalesceStream.on("data",this.trigger.bind(this,"data")),o.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(t){var n=this.transmuxPipeline_;if(this.baseMediaDecodeTime=t,i)i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,u(i),i.timelineStartInfo.baseMediaDecodeTime=t;if(e){if(n.videoSegmentStream)n.videoSegmentStream.gopCache_=[];e.timelineStartInfo.dts=void 0,e.timelineStartInfo.pts=void 0,u(e),e.timelineStartInfo.baseMediaDecodeTime=t}},this.push=function(t){if(c){var e=l(t);if(e&&"aac"!==this.transmuxPipeline_.type)this.setupAacPipeline();else if(!e&&"ts"!==this.transmuxPipeline_.type)this.setupTsPipeline();c=!1}this.transmuxPipeline_.headOfPipeline.push(t)},this.flush=function(){c=!0,this.transmuxPipeline_.headOfPipeline.flush()}},o.prototype=new f,e.exports={Transmuxer:o,VideoSegmentStream:n,AudioSegmentStream:r,AUDIO_PROPERTIES:_,VIDEO_PROPERTIES:w}},{"../aac":67,"../codecs/adts.js":68,"../codecs/h264":69,"../m2ts/m2ts.js":74,"../utils/stream.js":81,"./mp4-generator.js":78}],80:[function(t,e,i){"use strict";var n;n=function(t){var e=t.byteLength,i=0,n=0;this.length=function(){return 8*e},this.bitsAvailable=function(){return 8*e+n},this.loadWord=function(){var r=t.byteLength-e,o=new Uint8Array(4),s=Math.min(4,e);if(0===s)throw new Error("no bytes available");o.set(t.subarray(r,r+s)),i=new DataView(o.buffer).getUint32(0),n=8*s,e-=s},this.skipBits=function(t){var r;if(n>t)i<<=t,n-=t;else t-=n,r=Math.floor(t/8),t-=8*r,e-=r,this.loadWord(),i<<=t,n-=t},this.readBits=function(t){var r=Math.min(n,t),o=i>>>32-r;if(n-=r,n>0)i<<=r;else if(e>0)this.loadWord();if(r=t-r,r>0)return o<<r|this.readBits(r);else return o},this.skipLeadingZeros=function(){var t;for(t=0;t<n;++t)if(0!==(i&2147483648>>>t))return i<<=t,n-=t,t;return this.loadWord(),t+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var t=this.skipLeadingZeros();return this.readBits(t+1)-1},this.readExpGolomb=function(){var t=this.readUnsignedExpGolomb();if(1&t)return 1+t>>>1;else return-1*(t>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()},e.exports=n},{}],81:[function(t,e,i){"use strict";var n=function(){this.init=function(){var t={};this.on=function(e,i){if(!t[e])t[e]=[];t[e].push(i)},this.off=function(e,i){var n;if(!t[e])return!1;else return n=t[e].indexOf(i),t[e].splice(n,1),n>-1},this.trigger=function(e){var i,n,r,o;if(i=t[e])if(2===arguments.length)for(r=i.length,n=0;n<r;++n)i[n].call(this,arguments[1]);else{for(o=[],n=arguments.length,n=1;n<arguments.length;++n)o.push(arguments[n]);for(r=i.length,n=0;n<r;++n)i[n].apply(this,o)}},this.dispose=function(){t={}}}};n.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),t},n.prototype.push=function(t){this.trigger("data",t)},n.prototype.flush=function(t){this.trigger("done",t)},e.exports=n},{}],82:[function(t,e,i){"use strict";var n;e.exports=function(t){var e=n[t.byteLength%16||0],i=new Uint8Array(t.byteLength+e.length);return i.set(t),i.set(e,t.byteLength),i},n=[[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[14,14,14,14,14,14,14,14,14,14,14,14,14,14],[13,13,13,13,13,13,13,13,13,13,13,13,13],[12,12,12,12,12,12,12,12,12,12,12,12],[11,11,11,11,11,11,11,11,11,11,11],[10,10,10,10,10,10,10,10,10,10],[9,9,9,9,9,9,9,9,9],[8,8,8,8,8,8,8,8],[7,7,7,7,7,7,7],[6,6,6,6,6,6],[5,5,5,5,5],[4,4,4,4],[3,3,3],[2,2],[1]]},{}],83:[function(t,e,i){"use strict";i.pad=t("./pad.js"),i.unpad=t("./unpad.js")},{"./pad.js":82,"./unpad.js":84}],84:[function(t,e,i){"use strict";e.exports=function(t){return t.subarray(0,t.byteLength-t[t.byteLength-1])}},{}],85:[function(t,e,i){(function(t){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var r="undefined"!=typeof window?window.videojs:"undefined"!=typeof t?t.videojs:null,o=n(r),s=function(t){Object.defineProperties(t.frame,{id:{get:function(){return o.default.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key}},value:{get:function(){return o.default.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data}},privateData:{get:function(){return o.default.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data}}})},a=function(t,e,i){var n=window.WebKitDataCue||window.VTTCue;if(e)e.forEach(function(t){this.inbandTextTrack_.addCue(new n(t.startTime+this.timestampOffset,t.endTime+this.timestampOffset,t.text))},t);if(i)i.forEach(function(t){var e=t.cueTime+this.timestampOffset;t.frames.forEach(function(t){var i=new n(e,e,t.value||t.url||t.data||"");i.frame=t,i.value=t,s(i),this.metadataTrack_.addCue(i)},this)},t)};i.default=a,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],86:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){return/mp4a\.\d+.\d+/i.test(t)},r=function(t){return/avc1\.[\da-f]+/i.test(t)},o=function(t){var e={type:"",parameters:{}},i=t.trim().split(";");return e.type=i.shift().trim(),i.forEach(function(t){var i=t.trim().split("=");if(i.length>1){var n=i[0].replace(/"/g,"").trim(),r=i[1].replace(/"/g,"").trim();e.parameters[n]=r}}),e};i.default={isAudioCodec:n,parseContentType:o,isVideoCodec:r},e.exports=i.default},{}],87:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t,e,i){if(i.captions&&i.captions.length&&!t.inbandTextTrack_)t.inbandTextTrack_=e.player_.addTextTrack("captions","cc1");if(i.metadata&&i.metadata.length&&!t.metadataTrack_)t.metadataTrack_=e.player_.addTextTrack("metadata","Timed Metadata"),t.metadataTrack_.inBandMetadataTrackDispatchType=i.metadata.dispatchType};i.default=n,e.exports=i.default},{}],88:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n={TIME_BETWEEN_TICKS:Math.floor(1e3/480),TIME_PER_TICK:Math.floor(1e3/240),BYTES_PER_CHUNK:1024,MIN_CHUNK:1024,MAX_CHUNK:1048576};i.default=n,e.exports=i.default},{}],89:[function(t,e,i){(function(n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),l=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},c="undefined"!=typeof window?window.videojs:"undefined"!=typeof n?n.videojs:null,u=r(c),d=t("./flash-source-buffer"),h=r(d),p=t("./flash-constants"),f=r(p),m=t("./codec-utils"),g=function(t){function e(){var t=this;o(this,e),l(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.sourceBuffers=[],this.readyState="closed",this.on(["sourceopen","webkitsourceopen"],function(e){if(t.swfObj=document.getElementById(e.swfId),t.player_=(0,u.default)(t.swfObj.parentNode),t.tech_=t.swfObj.tech,t.readyState="open",t.tech_.on("seeking",function(){for(var e=t.sourceBuffers.length;e--;)t.sourceBuffers[e].abort()}),t.swfObj)t.swfObj.vjs_load()})}return s(e,t),a(e,[{key:"addSeekableRange_",value:function(){}},{key:"addSourceBuffer",value:function(t){var e=(0,m.parseContentType)(t),i=void 0;if("video/mp2t"===e.type)i=new h.default(this);else throw new Error("NotSupportedError (Video.js)");return this.sourceBuffers.push(i),i}},{key:"endOfStream",value:function(t){if("network"===t)this.tech_.error(2);else if("decode"===t)this.tech_.error(3);if("ended"!==this.readyState)this.readyState="ended",this.swfObj.vjs_endOfStream()}}]),e}(u.default.EventTarget);i.default=g;try{Object.defineProperty(g.prototype,"duration",{get:function(){if(!this.swfObj)return NaN;else return this.swfObj.vjs_getProperty("duration")},set:function(t){var e=void 0,i=this.swfObj.vjs_getProperty("duration");if(this.swfObj.vjs_setProperty("duration",t),t<i)for(e=0;e<this.sourceBuffers.length;e++)this.sourceBuffers[e].remove(t,i);return t}})}catch(t){g.prototype.duration=NaN}for(var y in f.default)g[y]=f.default[y];e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./codec-utils":86,"./flash-constants":88,"./flash-source-buffer":90}],90:[function(t,e,i){(function(n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),l=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},c="undefined"!=typeof window?window.videojs:"undefined"!=typeof n?n.videojs:null,u=r(c),d=t("mux.js/lib/flv"),h=r(d),p=t("./remove-cues-from-track"),f=r(p),m=t("./create-text-tracks-if-necessary"),g=r(m),y=t("./add-text-track-data"),v=r(y),b=t("./flash-constants"),_=r(b),w=function(t){window.setTimeout(t,_.default.TIME_BETWEEN_TICKS)},x=function(t,e){if("number"!=typeof e||e<0)e=0;var i=Math.pow(10,e);return Math.round(t*i)/i},T=function(t){function e(t){var i=this;o(this,e),l(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var n=void 0;this.chunkSize_=_.default.BYTES_PER_CHUNK,this.buffer_=[],this.bufferSize_=0,this.basePtsOffset_=NaN,this.mediaSource=t,this.updating=!1,this.timestampOffset_=0,this.segmentParser_=new h.default.Transmuxer,this.segmentParser_.on("data",this.receiveBuffer_.bind(this)),n=window.btoa(String.fromCharCode.apply(null,Array.prototype.slice.call(this.segmentParser_.getFlvHeader()))),this.mediaSource.swfObj.vjs_appendBuffer(n),Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(t){if("number"==typeof t&&t>=0)this.timestampOffset_=t,this.segmentParser_=new h.default.Transmuxer,this.segmentParser_.on("data",this.receiveBuffer_.bind(this)),this.mediaSource.swfObj.vjs_discontinuity(),this.basePtsOffset_=NaN}}),Object.defineProperty(this,"buffered",{get:function(){if(!(this.mediaSource&&this.mediaSource.swfObj&&"vjs_getProperty"in this.mediaSource.swfObj))return u.default.createTimeRange();var t=this.mediaSource.swfObj.vjs_getProperty("buffered");if(t&&t.length)t[0][0]=x(t[0][0],3),t[0][1]=x(t[0][1],3);return u.default.createTimeRanges(t)}}),this.mediaSource.player_.on("seeked",function(){(0,f.default)(0,1/0,i.metadataTrack_),(0,f.default)(0,1/0,i.inbandTextTrack_)})}return s(e,t),a(e,[{key:"appendBuffer",value:function(t){var e=this,i=void 0,n=524288,r=0;if(this.updating)throw i=new Error("SourceBuffer.append() cannot be called while an update is in progress"),i.name="InvalidStateError",i.code=11,i;this.updating=!0,this.mediaSource.readyState="open",this.trigger({type:"update"});var o=function i(){if(e.segmentParser_.push(t.subarray(r,r+n)),r+=n,r<t.byteLength)w(i);else w(e.segmentParser_.flush.bind(e.segmentParser_))};o()}},{key:"abort",value:function(){if(this.buffer_=[],this.bufferSize_=0,this.mediaSource.swfObj.vjs_abort(),this.updating)this.updating=!1,this.trigger({type:"updateend"})}},{key:"remove",value:function(t,e){(0,f.default)(t,e,this.metadataTrack_),(0,f.default)(t,e,this.inbandTextTrack_),this.trigger({type:"update"}),this.trigger({type:"updateend"})}},{key:"receiveBuffer_",value:function(t){var e=this;(0,g.default)(this,this.mediaSource,t),(0,v.default)(this,t.captions,t.metadata),w(function(){var i=e.convertTagsToData_(t);if(0===e.buffer_.length)w(e.processBuffer_.bind(e));if(i)e.buffer_.push(i),e.bufferSize_+=i.byteLength})}},{key:"processBuffer_",value:function(){var t=void 0,e=void 0,i=void 0,n=void 0,r=void 0,o=0,s=0,a=+new Date,l=void 0;if(this.buffer_.length){do{if(s++,t=this.buffer_[0].subarray(o,o+this.chunkSize_),t.byteLength<this.chunkSize_||this.buffer_[0].byteLength===o+this.chunkSize_)o=0,this.buffer_.shift();else o+=this.chunkSize_;for(this.bufferSize_-=t.byteLength,n="",i=t.byteLength,e=0;e<i;e++)n+=String.fromCharCode(t[e]);r=window.btoa(n),this.mediaSource.swfObj.CallFunction('<invoke name="vjs_appendBuffer"returntype="javascript"><arguments><string>'+r+"</string></arguments></invoke>"),l=new Date-a}while(this.buffer_.length&&l<_.default.TIME_PER_TICK);if(this.buffer_.length&&o)this.buffer_[0]=this.buffer_[0].subarray(o);if(l>=_.default.TIME_PER_TICK)this.chunkSize_=Math.floor(this.chunkSize_*(s/4));if(this.chunkSize_=Math.max(_.default.MIN_CHUNK,Math.min(this.chunkSize_,_.default.MAX_CHUNK)),0!==this.bufferSize_)w(this.processBuffer_.bind(this));else this.updating=!1,this.trigger({type:"updateend"})}else if(this.updating!==!1)this.updating=!1,this.trigger({type:"updateend"})}},{key:"convertTagsToData_",value:function(t){var e=0,i=this.mediaSource.tech_,n=0,r=void 0,o=void 0,s=void 0,a=[],l=this.getOrderedTags_(t);if(isNaN(this.basePtsOffset_)&&l.length)this.basePtsOffset_=l[0].pts;if(i.buffered().length)n=i.buffered().end(0)-this.timestampOffset;for(n=Math.max(n,i.currentTime()-this.timestampOffset),n*=1e3,n+=this.basePtsOffset_,r=0;r<l.length;r++)if(l[r].pts>=n)a.push(l[r]);if(0!==a.length){for(r=0;r<a.length;r++)e+=a[r].bytes.byteLength;for(s=new Uint8Array(e),r=0,o=0;r<a.length;r++)s.set(a[r].bytes,o),o+=a[r].bytes.byteLength;return s}}},{key:"getOrderedTags_",value:function(t){for(var e=t.tags.videoTags,i=t.tags.audioTags,n=void 0,r=[];e.length||i.length;){if(!e.length)n=i.shift();else if(!i.length)n=e.shift();else if(i[0].dts<e[0].dts)n=i.shift();else n=e.shift();r.push(n.finalize())}return r}}]),e}(u.default.EventTarget);i.default=T,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./add-text-track-data":85,"./create-text-tracks-if-necessary":87,"./flash-constants":88,"./remove-cues-from-track":92,"mux.js/lib/flv":71}],91:[function(t,e,i){(function(n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),l=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},c="undefined"!=typeof window?window.videojs:"undefined"!=typeof n?n.videojs:null,u=r(c),d=t("./virtual-source-buffer"),h=r(d),p=t("./codec-utils"),f=function(t){return t.map(function(t){return t.replace(/avc1\.(\d+)\.(\d+)/i,function(t,e,i){var n=("00"+Number(e).toString(16)).slice(-2),r=("00"+Number(i).toString(16)).slice(-2);return"avc1."+n+"00"+r})})},m=function(t){function e(){var t=this;o(this,e),l(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var i=void 0;this.nativeMediaSource_=new window.MediaSource;for(i in this.nativeMediaSource_)if(!(i in e.prototype)&&"function"==typeof this.nativeMediaSource_[i])this[i]=this.nativeMediaSource_[i].bind(this.nativeMediaSource_);this.duration_=NaN,Object.defineProperty(this,"duration",{get:function(){if(this.duration_===1/0)return this.duration_;else return this.nativeMediaSource_.duration},set:function(t){if(this.duration_=t,t!==1/0)return void(this.nativeMediaSource_.duration=t)}}),Object.defineProperty(this,"seekable",{get:function(){if(this.duration_===1/0)return u.default.createTimeRanges([[0,this.nativeMediaSource_.duration]]);else return this.nativeMediaSource_.seekable}}),Object.defineProperty(this,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(this,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),this.sourceBuffers=[],this.activeSourceBuffers_=[],this.updateActiveSourceBuffers_=function(){t.activeSourceBuffers_.length=0;for(var e=!1,i=!0,n=0;n<t.player_.audioTracks().length;n++){var r=t.player_.audioTracks()[n];if(r.enabled&&"main"!==r.kind){e=!0,i=!1;break}}t.sourceBuffers.forEach(function(n){if(n.videoCodec_&&n.audioCodec_)n.audioDisabled_=e;else if(n.videoCodec_&&!n.audioCodec_)n.audioDisabled_=!0,i=!1;else if(!n.videoCodec_&&n.audioCodec_)if(n.audioDisabled_=i,i)return;t.activeSourceBuffers_.push(n)})},["sourceopen","sourceclose","sourceended"].forEach(function(t){this.nativeMediaSource_.addEventListener(t,this.trigger.bind(this))},this),this.on("sourceopen",function(e){var i=document.querySelector('[src="'+t.url_+'"]');if(i)if(t.player_=(0,u.default)(i.parentNode),t.player_.audioTracks&&t.player_.audioTracks())t.player_.audioTracks().on("change",t.updateActiveSourceBuffers_),t.player_.audioTracks().on("addtrack",t.updateActiveSourceBuffers_),t.player_.audioTracks().on("removetrack",t.updateActiveSourceBuffers_)}),this.on("sourceclose",function(t){if(this.sourceBuffers.forEach(function(t){if(t.transmuxer_)t.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_)if(this.player_.audioTracks&&this.player_.audioTracks())this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)})}return s(e,t),a(e,[{key:"addSeekableRange_",value:function(t,e){var i=void 0;if(this.duration!==1/0)throw i=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity"),i.name="InvalidStateError",i.code=11,i;if(e>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))this.nativeMediaSource_.duration=e}},{key:"addSourceBuffer",value:function(t){var e=void 0,i=(0,p.parseContentType)(t);if("video/mp2t"===i.type){var n=[];if(i.parameters&&i.parameters.codecs)n=i.parameters.codecs.split(","),n=f(n),n=n.filter(function(t){return(0,p.isAudioCodec)(t)||(0,p.isVideoCodec)(t)});if(0===n.length)n=["avc1.4d400d","mp4a.40.2"];if(e=new h.default(this,n),0!==this.sourceBuffers.length)this.sourceBuffers[0].createRealSourceBuffers_(),e.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0}else e=this.nativeMediaSource_.addSourceBuffer(t);return this.sourceBuffers.push(e),e}}]),e}(u.default.EventTarget);i.default=m,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./codec-utils":86,"./virtual-source-buffer":95}],92:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t,e,i){var n=void 0,r=void 0;if(i)for(n=i.cues.length;n--;)if(r=i.cues[n],r.startTime<=e&&r.endTime>=t)i.removeCue(r)};i.default=n,e.exports=i.default},{}],93:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),s=t("mux.js/lib/mp4"),a=n(s),l=function(t){if(t.on("data",function(t){var e=t.data;t.data=e.buffer,postMessage({action:"data",segment:t,byteOffset:e.byteOffset,byteLength:e.byteLength},[t.data])}),t.captionStream)t.captionStream.on("data",function(t){postMessage({action:"caption",data:t})});t.on("done",function(t){postMessage({action:"done"})})},c=function(){function t(e){r(this,t),this.options=e||{},this.init()}return o(t,[{key:"init",value:function(){if(this.transmuxer)this.transmuxer.dispose();this.transmuxer=new a.default.Transmuxer(this.options),l(this.transmuxer)}},{key:"push",value:function(t){var e=new Uint8Array(t.data,t.byteOffset,t.byteLength);this.transmuxer.push(e)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(t){var e=t.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*e))}},{key:"flush",value:function(t){this.transmuxer.flush()}}]),t}(),u=function(t){t.onmessage=function(t){if("init"===t.data.action&&t.data.options)return void(this.messageHandlers=new c(t.data.options));if(!this.messageHandlers)this.messageHandlers=new c;if(t.data&&t.data.action&&"init"!==t.data.action)if(this.messageHandlers[t.data.action])this.messageHandlers[t.data.action](t.data)}};i.default=function(t){return new u(t)},e.exports=i.default},{"mux.js/lib/mp4":77}],94:[function(t,e,i){(function(e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var r=t("./flash-media-source"),o=n(r),s=t("./html-media-source"),a=n(s),l="undefined"!=typeof window?window.videojs:"undefined"!=typeof e?e.videojs:null,c=n(l),u=0,d={mode:"auto"};c.default.mediaSources={};var h=function(t,e){var i=c.default.mediaSources[t];if(i)i.trigger({type:"sourceopen",swfId:e});else throw new Error("Media Source not found (Video.js)")},p=function(){return!!window.MediaSource&&!!window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},f=function(t){var e=c.default.mergeOptions(d,t);if(this.MediaSource={open:h,supportsNativeMediaSources:p},"html5"===e.mode||"auto"===e.mode&&p())return new a.default;else return new o.default};i.MediaSource=f,f.open=h,f.supportsNativeMediaSources=p;var m={createObjectURL:function(t){var e="blob:vjs-media-source/",i=void 0;if(t instanceof a.default)return i=window.URL.createObjectURL(t.nativeMediaSource_),t.url_=i,i;if(!(t instanceof o.default))return i=window.URL.createObjectURL(t),t.url_=i,i;else return i=e+u,u++,c.default.mediaSources[i]=t,i}};i.URL=m,c.default.MediaSource=f,c.default.URL=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./flash-media-source":89,"./html-media-source":91}],95:[function(t,e,i){(function(n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),l=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},c="undefined"!=typeof window?window.videojs:"undefined"!=typeof n?n.videojs:null,u=r(c),d=t("./create-text-tracks-if-necessary"),h=r(d),p=t("./remove-cues-from-track"),f=r(p),m=t("./add-text-track-data"),g=r(m),y=t("webworkify"),v=r(y),b=t("./transmuxer-worker"),_=r(b),w=t("./codec-utils"),x=function(t){function e(t,i){var n=this;o(this,e),l(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,u.default.EventTarget),this.timestampOffset_=0,this.pendingBuffers_=[],this.bufferUpdating_=!1,this.mediaSource_=t,this.codecs_=i,this.audioCodec_=null,this.videoCodec_=null,this.audioDisabled_=!1;var r={remux:!1};this.codecs_.forEach(function(t){if((0,w.isAudioCodec)(t))n.audioCodec_=t;else if((0,w.isVideoCodec)(t))n.videoCodec_=t}),this.transmuxer_=(0,v.default)(_.default),this.transmuxer_.postMessage({action:"init",options:r}),this.transmuxer_.onmessage=function(t){if("data"===t.data.action)return n.data_(t);if("done"===t.data.action)return n.done_(t);else return},Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(t){if("number"==typeof t&&t>=0)this.timestampOffset_=t,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:t})}}),Object.defineProperty(this,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(t){if(this.videoBuffer_)this.videoBuffer_.appendWindowStart=t;if(this.audioBuffer_)this.audioBuffer_.appendWindowStart=t}}),Object.defineProperty(this,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(this,"buffered",{get:function(){var t=null,e=null,i=0,n=[],r=[];if(!this.videoBuffer_&&(this.audioDisabled_||!this.audioBuffer_))return u.default.createTimeRange();if(!this.videoBuffer_)return this.audioBuffer_.buffered;else if(this.audioDisabled_||!this.audioBuffer_)return this.videoBuffer_.buffered;if(!(this.videoBuffer_&&0!==this.videoBuffer_.buffered.length||this.audioBuffer_&&0!==this.audioBuffer_.buffered.length))return u.default.createTimeRange();for(var o=this.videoBuffer_.buffered,s=this.audioBuffer_.buffered,a=o.length;a--;)n.push({time:o.start(a),type:"start"}),n.push({time:o.end(a),type:"end"});for(a=s.length;a--;)n.push({time:s.start(a),type:"start"}),n.push({time:s.end(a),type:"end"});for(n.sort(function(t,e){return t.time-e.time}),a=0;a<n.length;a++){if("start"===n[a].type){if(i++,2===i)t=n[a].time}else if("end"===n[a].type)if(i--,1===i)e=n[a].time;if(null!==t&&null!==e)r.push([t,e]),t=null,e=null}return u.default.createTimeRanges(r)}})}return s(e,t),a(e,[{key:"data_",value:function(t){var e=t.data.segment;e.data=new Uint8Array(e.data,t.data.byteOffset,t.data.byteLength),(0,h.default)(this,this.mediaSource_,e),this.pendingBuffers_.push(e)}},{key:"done_",value:function(t){this.processPendingSegments_()}},{key:"createRealSourceBuffers_",value:function(){var t=this,e=["audio","video"];e.forEach(function(i){if(t[i+"Codec_"])if(!t[i+"Buffer_"]){var n=null;if(t.mediaSource_[i+"Buffer_"])n=t.mediaSource_[i+"Buffer_"];else n=t.mediaSource_.nativeMediaSource_.addSourceBuffer(i+'/mp4;codecs="'+t[i+"Codec_"]+'"'),t.mediaSource_[i+"Buffer_"]=n;t[i+"Buffer_"]=n,["update","updatestart","updateend"].forEach(function(r){n.addEventListener(r,function(){if("audio"!==i||!t.audioDisabled_){var n=e.every(function(e){if("audio"===e&&t.audioDisabled_)return!0;if(i!==e&&t[e+"Buffer_"]&&t[e+"Buffer_"].updating)return!1;else return!0});if(n)return t.trigger(r);else return}})})}})}},{key:"appendBuffer",value:function(t){this.bufferUpdating_=!0,this.transmuxer_.postMessage({action:"push",data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength},[t.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"remove",value:function(t,e){if(this.videoBuffer_)this.videoBuffer_.remove(t,e);if(!this.audioDisabled_&&this.audioBuffer_)this.audioBuffer_.remove(t,e);(0,f.default)(t,e,this.metadataTrack_),(0,f.default)(t,e,this.inbandTextTrack_)}},{key:"processPendingSegments_",
value:function(){var t={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};if(t=this.pendingBuffers_.reduce(function(t,e){var i=e.type,n=e.data;if(t[i].segments.push(n),t[i].bytes+=n.byteLength,e.captions)t.captions=t.captions.concat(e.captions);if(e.info)t[i].info=e.info;if(e.metadata)t.metadata=t.metadata.concat(e.metadata);return t},t),!this.videoBuffer_&&!this.audioBuffer_){if(0===t.video.bytes)this.videoCodec_=null;if(0===t.audio.bytes)this.audioCodec_=null;this.createRealSourceBuffers_()}if(t.audio.info)this.mediaSource_.trigger({type:"audioinfo",info:t.audio.info});if(t.video.info)this.mediaSource_.trigger({type:"videoinfo",info:t.video.info});if(this.videoBuffer_)this.concatAndAppendSegments_(t.video,this.videoBuffer_),(0,g.default)(this,t.captions,t.metadata);if(!this.audioDisabled_&&this.audioBuffer_)this.concatAndAppendSegments_(t.audio,this.audioBuffer_);this.pendingBuffers_.length=0,this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(t,e){var i=0,n=void 0;if(t.bytes)n=new Uint8Array(t.bytes),t.segments.forEach(function(t){n.set(t,i),i+=t.byteLength}),e.appendBuffer(n)}},{key:"abort",value:function(){if(this.videoBuffer_)this.videoBuffer_.abort();if(this.audioBuffer_)this.audioBuffer_.abort();if(this.transmuxer_)this.transmuxer_.postMessage({action:"reset"});this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),e}(u.default.EventTarget);i.default=x,e.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./add-text-track-data":85,"./codec-utils":86,"./create-text-tracks-if-necessary":87,"./remove-cues-from-track":92,"./transmuxer-worker":93,webworkify:96}],96:[function(t,e,i){var n=arguments[3],r=arguments[4],o=arguments[5],s=JSON.stringify;e.exports=function(t){for(var e,i=Object.keys(o),a=0,l=i.length;a<l;a++){var c=i[a];if(o[c].exports===t){e=c;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var u={},a=0,l=i.length;a<l;a++){var c=i[a];u[c]=c}r[e]=[Function(["require","module","exports"],"("+t+")(self)"),u]}var d=Math.floor(Math.pow(16,8)*Math.random()).toString(16),h={};h[e]=e,r[d]=[Function(["require"],"require("+s(e)+")(self)"),h];var p="("+n+")({"+Object.keys(r).map(function(t){return s(t)+":["+r[t][0]+","+s(r[t][1])+"]"}).join(",")+"},{},["+s(d)+"])",f=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(f.createObjectURL(new Blob([p],{type:"text/javascript"})))}},{}],97:[function(t,e,i){(function(i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n)n.writable=!0;Object.defineProperty(t,n.key,n)}}return function(e,i,n){if(i)t(e.prototype,i);if(n)t(e,n);return e}}(),a=function(t,e,i){var n=!0;t:for(;n;){var r=t,o=e,s=i;if(n=!1,null===r)r=Function.prototype;var a=Object.getOwnPropertyDescriptor(r,o);if(void 0===a){var l=Object.getPrototypeOf(r);if(null===l)return;else{t=l,e=o,i=s,n=!0,a=l=void 0;continue t}}else if("value"in a)return a.value;else{var c=a.get;if(void 0===c)return;return c.call(s)}}},l=t("global/document"),c=n(l),u=t("./playlist-loader"),d=n(u),h=t("./playlist"),p=n(h),f=t("./xhr"),m=n(f),g=t("aes-decrypter"),y=t("./bin-utils"),v=n(y),b=t("videojs-contrib-media-sources"),_=t("m3u8-parser"),w=n(_),x="undefined"!=typeof window?window.videojs:"undefined"!=typeof i?i.videojs:null,T=n(x),k=t("./master-playlist-controller"),S=n(k),j=t("./config"),E=n(j),P=t("./rendition-mixin"),C=n(P),O=t("./gap-skipper"),M=n(O),I=function(t,e){if(typeof t!=typeof e)return!0;if(Object.keys(t).length!==Object.keys(e).length)return!0;for(var i in t)if(!e[i]||t[i]!==e[i])return!0;return!1},A={PlaylistLoader:d.default,Playlist:p.default,Decrypter:g.Decrypter,AsyncStream:g.AsyncStream,decrypt:g.decrypt,utils:v.default,xhr:(0,m.default)()};Object.defineProperty(A,"GOAL_BUFFER_LENGTH",{get:function(){return T.default.log.warn("using Hls.GOAL_BUFFER_LENGTH is UNSAFE be sure you know what you are doing"),E.default.GOAL_BUFFER_LENGTH},set:function(t){if(T.default.log.warn("using Hls.GOAL_BUFFER_LENGTH is UNSAFE be sure you know what you are doing"),"number"!=typeof t||t<=0)return void T.default.log.warn("value passed to Hls.GOAL_BUFFER_LENGTH must be a number and greater than 0");else return void(E.default.GOAL_BUFFER_LENGTH=t)}});var D=1.2,N=function(t,e){var i=void 0;if(!t)return"";if(i=getComputedStyle(t),!i)return"";else return i[e]};A.STANDARD_PLAYLIST_SELECTOR=function(){var t=void 0,e=this.playlists.master.playlists.slice(),i=[],n=+new Date,r=void 0,o=void 0,s=void 0,a=void 0,l=void 0,c=void 0,u=void 0,d=void 0;for(e.sort(A.comparePlaylistBandwidth),e=e.filter(function(t){if("undefined"!=typeof t.excludeUntil)return n>=t.excludeUntil;else return!0}),r=e.length;r--;)if(o=e[r],o.attributes&&o.attributes.BANDWIDTH){if(t=o.attributes.BANDWIDTH*D,t<this.bandwidth)if(i.push(o),!s)s=o}else;for(r=i.length,i.sort(A.comparePlaylistResolution),o=null,u=parseInt(N(this.tech_.el(),"width"),10),d=parseInt(N(this.tech_.el(),"height"),10);r--;)if(o=i[r],o.attributes&&o.attributes.RESOLUTION&&o.attributes.RESOLUTION.width&&o.attributes.RESOLUTION.height){var h=o.attributes.RESOLUTION;if(h.width===u&&h.height===d){a=null,c=o;break}else if(h.width<u&&h.height<d)break;else if(!a||h.width<l.width&&h.height<l.height)a=o,l=a.attributes.RESOLUTION}else;return a||c||s||e[0]},A.canPlaySource=function(){return T.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},A.supportsNativeHls=function(){var t=c.default.createElement("video");if(!T.default.getComponent("Html5").isSupported())return!1;var e=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return e.some(function(e){return/maybe|probably/i.test(t.canPlayType(e))})}(),A.isSupported=function(){return T.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var L=T.default.getComponent("Component"),B=function(t){function e(t,i,n){var o=this;if(r(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,i),i.options_&&i.options_.playerId){var s=(0,T.default)(i.options_.playerId);if(!s.hasOwnProperty("hls"))Object.defineProperty(s,"hls",{get:function(){return T.default.log.warn("player.hls is deprecated. Use player.tech.hls instead."),o}})}this.tech_=i,this.source_=t,this.stats={},this.options_=T.default.mergeOptions(T.default.options.hls||{},n.hls),this.setOptions_(),this.on(c.default,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(t){var e=c.default.fullscreenElement||c.default.webkitFullscreenElement||c.default.mozFullScreenElement||c.default.msFullscreenElement;if(e&&e.contains(o.tech_.el()))o.masterPlaylistController_.fastQualityChange_()}),this.on(this.tech_,"seeking",function(){this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){if(this.masterPlaylistController_)this.masterPlaylistController_.pauseLoading()}),this.audioTrackChange_=function(){o.masterPlaylistController_.useAudio()},this.on(this.tech_,"play",this.play)}return o(e,t),s(e,[{key:"setOptions_",value:function(){var t=this;this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.bandwidth=this.options_.bandwidth||4194304,["withCredentials","bandwidth"].forEach(function(e){if("undefined"!=typeof t.source_[e])t.options_[e]=t.source_[e]}),this.bandwidth=this.options_.bandwidth}},{key:"setSource",value:function(t){this.src(t.src)}},{key:"src",value:function(t){var e=this;if(t)if(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=A,this.masterPlaylistController_=new S.default(this.options_),this.gapSkipper_=new M.default(this.options_),this.masterPlaylistController_.selectPlaylist=A.STANDARD_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(t){this.masterPlaylistController_.selectPlaylist=t.bind(this)}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(t){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=t}}}),Object.defineProperty(this.stats,"bandwidth",{get:function(){return e.bandwidth||0}}),Object.defineProperty(this.stats,"mediaRequests",{get:function(){return e.masterPlaylistController_.mediaRequests_()||0}}),Object.defineProperty(this.stats,"mediaTransferDuration",{get:function(){return e.masterPlaylistController_.mediaTransferDuration_()||0}}),Object.defineProperty(this.stats,"mediaBytesTransferred",{get:function(){return e.masterPlaylistController_.mediaBytesTransferred_()||0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.masterPlaylistController_.on("sourceopen",function(){e.tech_.audioTracks().addEventListener("change",e.audioTrackChange_)}),this.masterPlaylistController_.on("audioinfo",function(t){if(!T.default.browser.IS_FIREFOX||!e.audioInfo_||!I(e.audioInfo_,t.info))return void(e.audioInfo_=t.info);var i="had different audio properties (channels, sample rate, etc.) or changed in some other way.  This behavior is currently unsupported in Firefox due to an issue: \n\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1247138\n\n",n=void 0,r=void 0;if(e.masterPlaylistController_.audioTracks_.forEach(function(t){if(!r&&t.default)r=t;if(!n&&t.enabled)n=t}),!n.getLoader(e.activeAudioGroup_()))i="The rendition that we tried to switch to "+i+"Unfortunately that means we will have to blacklist the current playlist and switch to another. Sorry!",e.masterPlaylistController_.blacklistCurrentPlaylist();else i="The audio track '"+n.label+"' that we tried to "+("switch to "+i+" Unfortunately this means we will have to ")+("return you to the main track '"+r.label+"'. Sorry!"),r.enabled=!0,e.tech_.audioTracks().removeTrack(n);T.default.log.warn(i),e.masterPlaylistController_.useAudio()}),this.masterPlaylistController_.on("selectedinitialmedia",function(){e.tech_.clearTracks("audio"),e.masterPlaylistController_.audioTracks_.forEach(function(t){e.tech_.audioTracks().addTrack(t)}),(0,C.default)(e)}),this.on(this.masterPlaylistController_,"progress",function(){this.bandwidth=this.masterPlaylistController_.mainSegmentLoader_.bandwidth,this.tech_.trigger("progress")}),this.tech_.el())this.tech_.src(T.default.URL.createObjectURL(this.masterPlaylistController_.mediaSource))}},{key:"activeAudioGroup_",value:function(){return this.masterPlaylistController_.activeAudioGroup()}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(t){this.masterPlaylistController_.setCurrentTime(t)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){if(this.masterPlaylistController_)this.masterPlaylistController_.dispose();this.gapSkipper_.dispose(),this.tech_.audioTracks().removeEventListener("change",this.audioTrackChange_),a(Object.getPrototypeOf(e.prototype),"dispose",this).call(this)}}]),e}(L),U=function t(e){return{canHandleSource:function(i){if(T.default.options.hls&&T.default.options.hls.mode&&T.default.options.hls.mode!==e)return!1;else return t.canPlayType(i.type)},handleSource:function(t,i,n){if("flash"===e)i.setTimeout(function(){i.trigger("loadstart")},1);var r=T.default.mergeOptions(n,{hls:{mode:e}});if(i.hls=new B(t,i,r),i.hls.xhr=(0,m.default)(),T.default.Hls.xhr.beforeRequest)i.hls.xhr.beforeRequest=T.default.Hls.xhr.beforeRequest;return i.hls.src(t.src),i.hls},canPlayType:function(e){if(t.canPlayType(e))return"maybe";else return""}}};if(A.comparePlaylistBandwidth=function(t,e){var i=void 0,n=void 0;if(t.attributes&&t.attributes.BANDWIDTH)i=t.attributes.BANDWIDTH;if(i=i||window.Number.MAX_VALUE,e.attributes&&e.attributes.BANDWIDTH)n=e.attributes.BANDWIDTH;return n=n||window.Number.MAX_VALUE,i-n},A.comparePlaylistResolution=function(t,e){var i=void 0,n=void 0;if(t.attributes&&t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width)i=t.attributes.RESOLUTION.width;if(i=i||window.Number.MAX_VALUE,e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width)n=e.attributes.RESOLUTION.width;if(n=n||window.Number.MAX_VALUE,i===n&&t.attributes.BANDWIDTH&&e.attributes.BANDWIDTH)return t.attributes.BANDWIDTH-e.attributes.BANDWIDTH;else return i-n},U.canPlayType=function(t){var e=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;return e.test(t)},"undefined"==typeof T.default.MediaSource||"undefined"==typeof T.default.URL)T.default.MediaSource=b.MediaSource,T.default.URL=b.URL;if(b.MediaSource.supportsNativeMediaSources())T.default.getComponent("Html5").registerSourceHandler(U("html5"));if(window.Uint8Array)T.default.getComponent("Flash").registerSourceHandler(U("flash"));T.default.HlsHandler=B,T.default.HlsSourceHandler=U,T.default.Hls=A,T.default.m3u8=w.default,T.default.registerComponent("Hls",A),T.default.options.hls=T.default.options.hls||{},e.exports={Hls:A,HlsHandler:B,HlsSourceHandler:U}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./bin-utils":1,"./config":2,"./gap-skipper":3,"./master-playlist-controller":5,"./playlist":7,"./playlist-loader":6,"./rendition-mixin":9,"./xhr":14,"aes-decrypter":18,"global/document":23,"m3u8-parser":61,"videojs-contrib-media-sources":94}]},{},[97])(97)});